<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Deploying React.js App on GAE | The work is undone.</title><meta name="description" content="asukachikaru&#x27;s blog"/><meta property="og:title" content="Deploying React.js App on GAE | The work is undone."/><meta property="twitter:title" content="Deploying React.js App on GAE | The work is undone."/><meta name="next-head-count" content="6"/><link rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/3f14b923204890a1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/3f14b923204890a1.css" data-n-g=""/><link rel="preload" href="/_next/static/css/d8403707d10b0477.css" as="style"/><link rel="stylesheet" href="/_next/static/css/d8403707d10b0477.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-b8f8d6679aaa5f42.js" defer=""></script><script src="/_next/static/chunks/framework-114634acb84f8baa.js" defer=""></script><script src="/_next/static/chunks/main-f2ca60db2beb93ed.js" defer=""></script><script src="/_next/static/chunks/pages/_app-17babe11a04a8b75.js" defer=""></script><script src="/_next/static/chunks/118-9f8d344ce3900aa3.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bpathname%5D-ae7676ded4422893.js" defer=""></script><script src="/_next/static/y6fsH4Oeuc4QFYGMk-xHa/_buildManifest.js" defer=""></script><script src="/_next/static/y6fsH4Oeuc4QFYGMk-xHa/_ssgManifest.js" defer=""></script></head><body><div id="__next"><main class="__variable_cfcccd font-serif"><div class="max-w-7xl mx-auto grid grid-cols-12 gap-0 lg:gap-4"><div class="my-12 col-span-10 col-start-2 lg:col-span-7 lg:col-start-3"><h1 class="mb-2 text-3xl lg:text-6xl font-extrabold">Deploying React.js App on GAE</h1><div class="text-md lg:text-xl"><span class="inline-block mr-2 pr-2 true">Sep. 19, 2019</span></div></div><div class="col-span-10 col-start-2 lg:col-span-7 lg:col-start-3"><div class="mb-6 text-lg lg:text-xl lg:leading-8"><span><span>For people like me who have only used a static host like Amazon S3 before, deploying React app on Google App Engine is a challenge. For all the references I found it looks straightforward and easy to deploy a React app, yet I still struggled for 2 days. Here is how I did it, with the things I realized by logs and tries and errors.</span></span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><h3 class="mt-8 text-xl lg:text-3xl font-semibold"><span>GAE is not a static host; it&#x27;s a virtual machine</span></h3></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><span><span>So you can&#x27;t just push the build. You have to serve it, like starting a development server. So the next problem is, how?</span></span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><h3 class="mt-8 text-xl lg:text-3xl font-semibold"><span>With default config, GAE only executes two scripts when deploying</span></h3></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><span><span>They are </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">npm install</code><span> and </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">npm start</code><span>.</span></span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><span><span>Like I mentioned before, for merely starting a server for React, these two seems enough. Then I found out it&#x27;s not, because default </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">npm start</code><span> provided by Create-React-App, which equals to </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">node scripts/start.js</code><span> if you check out </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">package.json</code><span>, takes much time, and it&#x27;s long enough to make the app not working. So we need a faster way to </span><span class="italic"><span>serve</span></span><span> it.</span></span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><h3 class="mt-8 text-xl lg:text-3xl font-semibold"><span>Serve can do the trick</span></h3></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><span><span>Literally, </span><a href="notion://www.notion.so/asukachikaru/%5B%3Chttps://github.com/zeit/serve%3E%5D(%3Chttps://github.com/zeit/serve%3E)" class="text-blue-400 underline" rel="noreferrer noopener" target="_blank"><span>serve</span></a><span>.</span></span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><span><span>Notice serve needs static files to run, so we need to build it first. Since GAE only runs two scripts, and building takes some time too, so I bound it to </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">postinstall</code><span> instead of </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">prestart</code><span> . By this way, GAE automatically builds right after it installs dependencies.</span></span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><span><span>You can also use some host framework (like express) to do the hosting and routing stuff too.</span></span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><h3 class="mt-8 text-xl lg:text-3xl font-semibold"><span>Config the port</span></h3></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><span><span>React development server default port is 3000, and serve&#x27;s is 5000, while GAE uses 8080.</span></span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><span><span>The scripts in </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">package.json</code><span> I used when finally successfully deployed looks like this:</span></span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><pre class="my-6 border rounded-md text-base leading-4"><code class="font-courier language-json rounded-md">&quot;script&quot;: {
  &quot;postinstall&quot;: &quot;npm run build&quot;,
  &quot;start&quot;: &quot;serve -l 8080 -s build&quot;
}</code></pre></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><span><span>You need to configure app.yaml too, but I think many resources is talking about how to do it.</span></span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><span><span>I hope this helps!</span></span></div></div><div class="mt-16 mb-5 text-center col-span-12 lg:col-span-8 lg:col-start-3"><a href="https://asukachikaru.com" rel="noopener noreferrer" target="_blank">asukachikaru.com</a> <!-- -->2018-</div></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postContent":[{"type":"paragraph","children":[{"type":"text","value":"For people like me who have only used a static host like Amazon S3 before, deploying React app on Google App Engine is a challenge. For all the references I found it looks straightforward and easy to deploy a React app, yet I still struggled for 2 days. Here is how I did it, with the things I realized by logs and tries and errors.","position":{"start":{"line":11,"column":1,"offset":233},"end":{"line":11,"column":333,"offset":565}}}]},{"type":"heading","depth":2,"children":[{"type":"text","value":"GAE is not a static host; it's a virtual machine","position":{"start":{"line":13,"column":4,"offset":570},"end":{"line":13,"column":52,"offset":618}}}]},{"type":"paragraph","children":[{"type":"text","value":"So you can't just push the build. You have to serve it, like starting a development server. So the next problem is, how?","position":{"start":{"line":15,"column":1,"offset":620},"end":{"line":15,"column":121,"offset":740}}}]},{"type":"heading","depth":2,"children":[{"type":"text","value":"With default config, GAE only executes two scripts when deploying","position":{"start":{"line":17,"column":4,"offset":745},"end":{"line":17,"column":69,"offset":810}}}]},{"type":"paragraph","children":[{"type":"text","value":"They are ","position":{"start":{"line":19,"column":1,"offset":812},"end":{"line":19,"column":10,"offset":821}}},{"type":"inlineCode","value":"npm install","position":{"start":{"line":19,"column":10,"offset":821},"end":{"line":19,"column":23,"offset":834}}},{"type":"text","value":" and ","position":{"start":{"line":19,"column":23,"offset":834},"end":{"line":19,"column":28,"offset":839}}},{"type":"inlineCode","value":"npm start","position":{"start":{"line":19,"column":28,"offset":839},"end":{"line":19,"column":39,"offset":850}}},{"type":"text","value":".","position":{"start":{"line":19,"column":39,"offset":850},"end":{"line":19,"column":40,"offset":851}}}]},{"type":"paragraph","children":[{"type":"text","value":"Like I mentioned before, for merely starting a server for React, these two seems enough. Then I found out it's not, because default ","position":{"start":{"line":21,"column":1,"offset":853},"end":{"line":21,"column":133,"offset":985}}},{"type":"inlineCode","value":"npm start","position":{"start":{"line":21,"column":133,"offset":985},"end":{"line":21,"column":144,"offset":996}}},{"type":"text","value":" provided by Create-React-App, which equals to ","position":{"start":{"line":21,"column":144,"offset":996},"end":{"line":21,"column":191,"offset":1043}}},{"type":"inlineCode","value":"node scripts/start.js","position":{"start":{"line":21,"column":191,"offset":1043},"end":{"line":21,"column":214,"offset":1066}}},{"type":"text","value":" if you check out ","position":{"start":{"line":21,"column":214,"offset":1066},"end":{"line":21,"column":232,"offset":1084}}},{"type":"inlineCode","value":"package.json","position":{"start":{"line":21,"column":232,"offset":1084},"end":{"line":21,"column":246,"offset":1098}}},{"type":"text","value":", takes much time, and it's long enough to make the app not working. So we need a faster way to ","position":{"start":{"line":21,"column":246,"offset":1098},"end":{"line":21,"column":342,"offset":1194}}},{"type":"emphasis","children":[{"type":"text","value":"serve","position":{"start":{"line":21,"column":343,"offset":1195},"end":{"line":21,"column":348,"offset":1200}}}],"position":{"start":{"line":21,"column":342,"offset":1194},"end":{"line":21,"column":349,"offset":1201}}},{"type":"text","value":" it.","position":{"start":{"line":21,"column":349,"offset":1201},"end":{"line":21,"column":353,"offset":1205}}}]},{"type":"heading","depth":2,"children":[{"type":"text","value":"Serve can do the trick","position":{"start":{"line":23,"column":4,"offset":1210},"end":{"line":23,"column":26,"offset":1232}}}]},{"type":"paragraph","children":[{"type":"text","value":"Literally, ","position":{"start":{"line":25,"column":1,"offset":1234},"end":{"line":25,"column":12,"offset":1245}}},{"type":"link","title":null,"url":"notion://www.notion.so/asukachikaru/%5B%3Chttps://github.com/zeit/serve%3E%5D(%3Chttps://github.com/zeit/serve%3E)","children":[{"type":"text","value":"serve","position":{"start":{"line":25,"column":13,"offset":1246},"end":{"line":25,"column":18,"offset":1251}}}],"position":{"start":{"line":25,"column":12,"offset":1245},"end":{"line":25,"column":135,"offset":1368}}},{"type":"text","value":".","position":{"start":{"line":25,"column":135,"offset":1368},"end":{"line":25,"column":136,"offset":1369}}}]},{"type":"paragraph","children":[{"type":"text","value":"Notice serve needs static files to run, so we need to build it first. Since GAE only runs two scripts, and building takes some time too, so I bound it to ","position":{"start":{"line":27,"column":1,"offset":1371},"end":{"line":27,"column":155,"offset":1525}}},{"type":"inlineCode","value":"postinstall","position":{"start":{"line":27,"column":155,"offset":1525},"end":{"line":27,"column":168,"offset":1538}}},{"type":"text","value":" instead of ","position":{"start":{"line":27,"column":168,"offset":1538},"end":{"line":27,"column":180,"offset":1550}}},{"type":"inlineCode","value":"prestart","position":{"start":{"line":27,"column":180,"offset":1550},"end":{"line":27,"column":190,"offset":1560}}},{"type":"text","value":" . By this way, GAE automatically builds right after it installs dependencies.","position":{"start":{"line":27,"column":190,"offset":1560},"end":{"line":27,"column":268,"offset":1638}}}]},{"type":"paragraph","children":[{"type":"text","value":"You can also use some host framework (like express) to do the hosting and routing stuff too.","position":{"start":{"line":29,"column":1,"offset":1640},"end":{"line":29,"column":93,"offset":1732}}}]},{"type":"heading","depth":2,"children":[{"type":"text","value":"Config the port","position":{"start":{"line":31,"column":4,"offset":1737},"end":{"line":31,"column":19,"offset":1752}}}]},{"type":"paragraph","children":[{"type":"text","value":"React development server default port is 3000, and serve's is 5000, while GAE uses 8080.","position":{"start":{"line":33,"column":1,"offset":1754},"end":{"line":33,"column":89,"offset":1842}}}]},{"type":"paragraph","children":[{"type":"text","value":"The scripts in ","position":{"start":{"line":35,"column":1,"offset":1844},"end":{"line":35,"column":16,"offset":1859}}},{"type":"inlineCode","value":"package.json","position":{"start":{"line":35,"column":16,"offset":1859},"end":{"line":35,"column":30,"offset":1873}}},{"type":"text","value":" I used when finally successfully deployed looks like this:","position":{"start":{"line":35,"column":30,"offset":1873},"end":{"line":35,"column":89,"offset":1932}}}]},{"type":"code","lang":"json","meta":null,"value":"\"script\": {\n  \"postinstall\": \"npm run build\",\n  \"start\": \"serve -l 8080 -s build\"\n}"},{"type":"paragraph","children":[{"type":"text","value":"You need to configure app.yaml too, but I think many resources is talking about how to do it.","position":{"start":{"line":44,"column":1,"offset":2031},"end":{"line":44,"column":94,"offset":2124}}}]},{"type":"paragraph","children":[{"type":"text","value":"I hope this helps!","position":{"start":{"line":46,"column":1,"offset":2126},"end":{"line":46,"column":19,"offset":2144}}}]}],"postSummary":{"id":"deploying-react-app-on-gae","title":"Deploying React.js App on GAE","category":"Front-end","language":["en-US"],"tags":["GAE","React.js"],"publishDate":"2019-09-19","pathname":"deploying-react-app-on-gae","zhTwLink":null,"filename":"Deploying React.js App on GAE (blog)"}},"__N_SSG":true},"page":"/post/[pathname]","query":{"pathname":"deploying-react-app-on-gae"},"buildId":"y6fsH4Oeuc4QFYGMk-xHa","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>
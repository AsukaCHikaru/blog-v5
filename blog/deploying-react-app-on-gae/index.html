<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Deploying React.js App on GAE | Asuka Wang</title><meta name="description" content="Asuka Wang&#x27;s blog"/><meta property="og:title" content="Deploying React.js App on GAE | Asuka Wang"/><meta property="twitter:title" content="Deploying React.js App on GAE | Asuka Wang"/><meta name="next-head-count" content="6"/><link rel="preload" href="/_next/static/css/7bb06dea9658773f.css" as="style"/><link rel="stylesheet" href="/_next/static/css/7bb06dea9658773f.css" data-n-g=""/><link rel="preload" href="/_next/static/css/85649d0ad2bd66a8.css" as="style"/><link rel="stylesheet" href="/_next/static/css/85649d0ad2bd66a8.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-b8f8d6679aaa5f42.js" defer=""></script><script src="/_next/static/chunks/framework-114634acb84f8baa.js" defer=""></script><script src="/_next/static/chunks/main-f2ca60db2beb93ed.js" defer=""></script><script src="/_next/static/chunks/pages/_app-a9b7d2090004d8b4.js" defer=""></script><script src="/_next/static/chunks/542-7be5b5539309fe0b.js" defer=""></script><script src="/_next/static/chunks/550-1833d3979cd8c210.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bpathname%5D-aadc79e0d0faed18.js" defer=""></script><script src="/_next/static/XLploX37j1DL40WYcuXfa/_buildManifest.js" defer=""></script><script src="/_next/static/XLploX37j1DL40WYcuXfa/_ssgManifest.js" defer=""></script></head><body><div id="__next"><main><div class="text-color Layout_container__S4aNf" data-is-menu-open="false"><div class="SiteHeader_container__8tKwA" data-is-menu-open="false"><div class="SiteHeader_nav-container__oEq2d"><div class="SiteHeader_section-container__tAKnZ"><a class="SiteHeader_section-link__9DmFE interactive-color text-color" href="/blog/">blog</a><a class="SiteHeader_section-link__9DmFE interactive-color " href="/about/">about</a></div><button class="SiteHeader_menu-button__eK9ND">menu</button><a class="SiteHeader_publication-folio___ZFZS text-color" href="/">ASUKA WANG</a></div><div class="SiteHeader_divider__cq_R_ border-color-100"></div><div class="SiteHeader_menu-wrapper__2evr7"></div></div><div class="Layout_full-content__MQIxS"><div class="PostDetailPageHeader_container__fcMw9"><div class="Layout_main-content__mr9_2"><h1 class="PostDetailPageHeader_title__YwZEK">Deploying React.js App on GAE</h1><div class="PostDetailPageHeader_publish-date__pMF22">September 19, 2019</div></div></div></div><div class="Layout_main-content__mr9_2"><div class="PostBodyBlock_wrapper__wRxJc"><span>For people like me who have only used a static host like Amazon S3 before, deploying React app on Google App Engine is a challenge. For all the references I found it looks straightforward and easy to deploy a React app, yet I still struggled for 2 days. Here is how I did it, with the things I realized by logs and tries and errors.</span></div><div class="PostBodyBlock_wrapper__wRxJc"><h3 class="PostBodyBlock_h3__BUDla" id="gae-is-not-a-static-host;-it&#x27;s-a-virtual-machine"><span>GAE is not a static host; it&#x27;s a virtual machine</span></h3></div><div class="PostBodyBlock_wrapper__wRxJc"><span>So you can&#x27;t just push the build. You have to serve it, like starting a development server. So the next problem is, how?</span></div><div class="PostBodyBlock_wrapper__wRxJc"><h3 class="PostBodyBlock_h3__BUDla" id="with-default-config--gae-only-executes-two-scripts-when-deploying"><span>With default config, GAE only executes two scripts when deploying</span></h3></div><div class="PostBodyBlock_wrapper__wRxJc"><span>They are </span><code class="PostBodyBlock_inline-code__TAzYM">npm install</code><span> and </span><code class="PostBodyBlock_inline-code__TAzYM">npm start</code><span>.</span></div><div class="PostBodyBlock_wrapper__wRxJc"><span>Like I mentioned before, for merely starting a server for React, these two seems enough. Then I found out it&#x27;s not, because default </span><code class="PostBodyBlock_inline-code__TAzYM">npm start</code><span> provided by Create-React-App, which equals to </span><code class="PostBodyBlock_inline-code__TAzYM">node scripts/start.js</code><span> if you check out </span><code class="PostBodyBlock_inline-code__TAzYM">package.json</code><span>, takes much time, and it&#x27;s long enough to make the app not working. So we need a faster way to </span><span class="PostBodyBlock_italic__lwNRw">serve</span><span> it.</span></div><div class="PostBodyBlock_wrapper__wRxJc"><h3 class="PostBodyBlock_h3__BUDla" id="serve-can-do-the-trick"><span>Serve can do the trick</span></h3></div><div class="PostBodyBlock_wrapper__wRxJc"><span>Literally, </span><a href="notion://www.notion.so/asukachikaru/%5B%3Chttps://github.com/zeit/serve%3E%5D(%3Chttps://github.com/zeit/serve%3E)" class="PostBodyBlock_link__faaEN" rel="noreferrer noopener" target="_blank">serve</a><span>.</span></div><div class="PostBodyBlock_wrapper__wRxJc"><span>Notice serve needs static files to run, so we need to build it first. Since GAE only runs two scripts, and building takes some time too, so I bound it to </span><code class="PostBodyBlock_inline-code__TAzYM">postinstall</code><span> instead of </span><code class="PostBodyBlock_inline-code__TAzYM">prestart</code><span> . By this way, GAE automatically builds right after it installs dependencies.</span></div><div class="PostBodyBlock_wrapper__wRxJc"><span>You can also use some host framework (like express) to do the hosting and routing stuff too.</span></div><div class="PostBodyBlock_wrapper__wRxJc"><h3 class="PostBodyBlock_h3__BUDla" id="config-the-port"><span>Config the port</span></h3></div><div class="PostBodyBlock_wrapper__wRxJc"><span>React development server default port is 3000, and serve&#x27;s is 5000, while GAE uses 8080.</span></div><div class="PostBodyBlock_wrapper__wRxJc"><span>The scripts in </span><code class="PostBodyBlock_inline-code__TAzYM">package.json</code><span> I used when finally successfully deployed looks like this:</span></div><div class="PostBodyBlock_wrapper__wRxJc"><pre class="CodeBlock_block__wRht1"><code class="CodeBlock_code__1aD9x language-json">&quot;script&quot;: {
  &quot;postinstall&quot;: &quot;npm run build&quot;,
  &quot;start&quot;: &quot;serve -l 8080 -s build&quot;
}</code></pre></div><div class="PostBodyBlock_wrapper__wRxJc"><span>You need to configure app.yaml too, but I think many resources is talking about how to do it.</span></div><div class="PostBodyBlock_wrapper__wRxJc"><span>I hope this helps!</span></div><div class="PostDetailPage_additional-list-container__b_oHL"><div class="AdditionalPostList_container__ucjfo"><div class="AdditionalPostList_category-link__EDTWa">More from<a href="/blog/archive/?category=Web%20Development">Web Development</a></div><div class="AdditionalPostList_card-list__jz3F_"><a class="AdditionalPostList_card__doJcw" href="/blog/nextjs-app-font-not-loaded-on-remote-machine-issue/"><div><div class="AdditionalPostList_card-title__FDhSX">Next.js App Font Not Loaded on Remote Machine Issue</div><div class="AdditionalPostList_card-description__Enc8v">Debugging note of a source loading issue that never reproduces on the dev machine.</div></div><div class="AdditionalPostList_card-publish-date__Jvdgm">June 5, 2023</div></a></div></div><div class="AdditionalPostList_container__ucjfo"><a class="AdditionalPostList_archive-link__7Q6ys" href="/blog/archive/">Archive</a><div class="AdditionalPostList_card-list__jz3F_"><a class="AdditionalPostList_card__doJcw" href="/blog/site-patch-notes-2024-redesign/"><div><div class="AdditionalPostList_card-title__FDhSX">Site Patch Notes: 2024 Redesign</div><div class="AdditionalPostList_card-description__Enc8v">The 2024 redesign is finally here! I went on a journey of learning editorial design, and did an overhaul to this site&#x27;s design, both functionality-wise and visual-wise.</div></div><div class="AdditionalPostList_card-publish-date__Jvdgm">August 18, 2024</div></a><a class="AdditionalPostList_card__doJcw" href="/blog/a-peek-of-the-world/"><div><div class="AdditionalPostList_card-title__FDhSX">A Peek of the World</div><div class="AdditionalPostList_card-description__Enc8v">I went to Copenhagen and London for my honeymoon, the first trip to Europe in my life. Some memories keep staying on my mind and I have many thoughts about them.</div></div><div class="AdditionalPostList_card-publish-date__Jvdgm">June 16, 2024</div></a><a class="AdditionalPostList_card__doJcw" href="/blog/godot-essentials/"><div><div class="AdditionalPostList_card-title__FDhSX">Godot Essentials</div><div class="AdditionalPostList_card-description__Enc8v">The biggest lessons I learned in my first Godot project.</div></div><div class="AdditionalPostList_card-publish-date__Jvdgm">April 21, 2024</div></a><a class="AdditionalPostList_card__doJcw" href="/blog/4-years-reflection/"><div><div class="AdditionalPostList_card-title__FDhSX">4 Years Reflection</div><div class="AdditionalPostList_card-description__Enc8v">Another two years of life as a full-time developer has passed. Many things changed and many lessons learned. It&#x27;s a perfect timing to look back and reflect.</div></div><div class="AdditionalPostList_card-publish-date__Jvdgm">April 8, 2024</div></a><a class="AdditionalPostList_card__doJcw" href="/blog/improving-greatness/"><div><div class="AdditionalPostList_card-title__FDhSX">Improving Greatness</div><div class="AdditionalPostList_card-description__Enc8v">Breath of the Wild is one of the most impactful game in last decade. Yet for its successor, Nintendo built an even more polished version on an already magnificent fundamental.</div></div><div class="AdditionalPostList_card-publish-date__Jvdgm">March 17, 2024</div></a></div></div></div></div><div class="Layout_right-panel__zSn4t"><div class="TableOfContentColumn_container__0tmUV"><ul class="TableOfContentColumn_ul__7wuVs interactive-list-color"><li class="TableOfContentColumn_li__FUe4z"><div class="TableOfContentColumn_indent__CXWB4"></div><button role="link" class="TableOfContentColumn_link__5qS3c">GAE is not a static host; it&#x27;s a virtual machine</button></li><li class="TableOfContentColumn_li__FUe4z"><div class="TableOfContentColumn_indent__CXWB4"></div><button role="link" class="TableOfContentColumn_link__5qS3c">With default config, GAE only executes two scripts when deploying</button></li><li class="TableOfContentColumn_li__FUe4z"><div class="TableOfContentColumn_indent__CXWB4"></div><button role="link" class="TableOfContentColumn_link__5qS3c">Serve can do the trick</button></li><li class="TableOfContentColumn_li__FUe4z"><div class="TableOfContentColumn_indent__CXWB4"></div><button role="link" class="TableOfContentColumn_link__5qS3c">Config the port</button></li></ul></div></div><div class="SiteFooter_container__0v6cR border-color"><a href="https://asukachikaru.com" rel="noopener noreferrer" target="_blank" class="SiteFooter_link__RuMSe interactive-color">asukachikaru.com 2018-</a></div></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postContent":[{"type":"paragraph","children":[{"type":"plain","text":"For people like me who have only used a static host like Amazon S3 before, deploying React app on Google App Engine is a challenge. For all the references I found it looks straightforward and easy to deploy a React app, yet I still struggled for 2 days. Here is how I did it, with the things I realized by logs and tries and errors."}]},{"type":"heading","children":[{"type":"plain","text":"GAE is not a static host; it's a virtual machine"}],"depth":2},{"type":"paragraph","children":[{"type":"plain","text":"So you can't just push the build. You have to serve it, like starting a development server. So the next problem is, how?"}]},{"type":"heading","children":[{"type":"plain","text":"With default config, GAE only executes two scripts when deploying"}],"depth":2},{"type":"paragraph","children":[{"type":"plain","text":"They are "},{"type":"inlineCode","text":"npm install"},{"type":"plain","text":" and "},{"type":"inlineCode","text":"npm start"},{"type":"plain","text":"."}]},{"type":"paragraph","children":[{"type":"plain","text":"Like I mentioned before, for merely starting a server for React, these two seems enough. Then I found out it's not, because default "},{"type":"inlineCode","text":"npm start"},{"type":"plain","text":" provided by Create-React-App, which equals to "},{"type":"inlineCode","text":"node scripts/start.js"},{"type":"plain","text":" if you check out "},{"type":"inlineCode","text":"package.json"},{"type":"plain","text":", takes much time, and it's long enough to make the app not working. So we need a faster way to "},{"type":"italic","text":"serve"},{"type":"plain","text":" it."}]},{"type":"heading","children":[{"type":"plain","text":"Serve can do the trick"}],"depth":2},{"type":"paragraph","children":[{"type":"plain","text":"Literally, "},{"type":"link","text":"serve","url":"notion://www.notion.so/asukachikaru/%5B%3Chttps://github.com/zeit/serve%3E%5D(%3Chttps://github.com/zeit/serve%3E)"},{"type":"plain","text":"."}]},{"type":"paragraph","children":[{"type":"plain","text":"Notice serve needs static files to run, so we need to build it first. Since GAE only runs two scripts, and building takes some time too, so I bound it to "},{"type":"inlineCode","text":"postinstall"},{"type":"plain","text":" instead of "},{"type":"inlineCode","text":"prestart"},{"type":"plain","text":" . By this way, GAE automatically builds right after it installs dependencies."}]},{"type":"paragraph","children":[{"type":"plain","text":"You can also use some host framework (like express) to do the hosting and routing stuff too."}]},{"type":"heading","children":[{"type":"plain","text":"Config the port"}],"depth":2},{"type":"paragraph","children":[{"type":"plain","text":"React development server default port is 3000, and serve's is 5000, while GAE uses 8080."}]},{"type":"paragraph","children":[{"type":"plain","text":"The scripts in "},{"type":"inlineCode","text":"package.json"},{"type":"plain","text":" I used when finally successfully deployed looks like this:"}]},{"type":"code","lang":"json","text":"\"script\": {\n  \"postinstall\": \"npm run build\",\n  \"start\": \"serve -l 8080 -s build\"\n}"},{"type":"paragraph","children":[{"type":"plain","text":"You need to configure app.yaml too, but I think many resources is talking about how to do it."}]},{"type":"paragraph","children":[{"type":"plain","text":"I hope this helps!"}]}],"postMetadata":{"id":"deploying-react-app-on-gae","title":"Deploying React.js App on GAE","description":"","category":"Web Development","tags":[],"publishDate":"2019-09-19","pathname":"deploying-react-app-on-gae"},"last5posts":[{"id":"site-patch-notes-2024-redesign","title":"Site Patch Notes: 2024 Redesign","description":"The 2024 redesign is finally here! I went on a journey of learning editorial design, and did an overhaul to this site's design, both functionality-wise and visual-wise.","category":"Meta","tags":[],"publishDate":"2024-08-18","pathname":"site-patch-notes-2024-redesign"},{"id":"a-peek-of-the-world","title":"A Peek of the World","description":"I went to Copenhagen and London for my honeymoon, the first trip to Europe in my life. Some memories keep staying on my mind and I have many thoughts about them.","category":"Life","tags":[],"publishDate":"2024-06-16","pathname":"a-peek-of-the-world"},{"id":"godot-essentials","title":"Godot Essentials","description":"The biggest lessons I learned in my first Godot project.","category":"Game Development","tags":[],"publishDate":"2024-04-21","pathname":"godot-essentials"},{"id":"4-years-reflection","title":"4 Years Reflection","description":"Another two years of life as a full-time developer has passed. Many things changed and many lessons learned. It's a perfect timing to look back and reflect.","category":"Life","tags":[],"publishDate":"2024-04-08","pathname":"4-years-reflection"},{"id":"improving-greatness","title":"Improving Greatness","description":"Breath of the Wild is one of the most impactful game in last decade. Yet for its successor, Nintendo built an even more polished version on an already magnificent fundamental.","category":"Gaming","tags":[],"publishDate":"2024-03-17","pathname":"improving-greatness"}],"categoryPosts":[{"id":"nextjs-app-font-not-loaded-on-remote-machine-issue","title":"Next.js App Font Not Loaded on Remote Machine Issue","description":"Debugging note of a source loading issue that never reproduces on the dev machine.","category":"Web Development","tags":[],"publishDate":"2023-06-05","pathname":"nextjs-app-font-not-loaded-on-remote-machine-issue"}],"categories":[{"name":"Meta","count":5},{"name":"Life","count":6},{"name":"Game Development","count":5},{"name":"Gaming","count":12},{"name":"League of Legends","count":8},{"name":"Web Development","count":4},{"name":"HKT48","count":4},{"name":"Programming","count":3},{"name":"Movie","count":2}]},"__N_SSG":true},"page":"/blog/[pathname]","query":{"pathname":"deploying-react-app-on-gae"},"buildId":"XLploX37j1DL40WYcuXfa","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>
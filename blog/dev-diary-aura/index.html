<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width"><title>Dev Diary: Aura | Asuka Wang</title><meta name="description" content="我嘗試了自己設計並實裝靈氣系統。它也許不顯眼，但絕不簡單。"><meta property="og:title" content="Dev Diary: Aura | Asuka Wang"><meta property="twitter:title" content="Dev Diary: Aura | Asuka Wang"><meta name="next-head-count" content="6"><link rel="preload" href="/_next/static/css/189e1174f0258bb3.css" as="style"><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/subfont/Gentium_Plus-400-62b8f514fb.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/subfont/Noto_Serif_JP_CJK-400-0edade8171.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/subfont/Noto_Serif_JP-400-10e25bcd0f.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/subfont/Gentium_Plus_Book-700-47a76121c3.woff2"><link rel="stylesheet" href="/subfont/fonts-7cdcf355c4.css"><link rel="stylesheet" href="/_next/static/css/189e1174f0258bb3.css" data-n-g=""><link rel="preload" href="/_next/static/css/76f66be5f297cc9e.css" as="style"><link rel="stylesheet" href="/_next/static/css/76f66be5f297cc9e.css" data-n-p=""><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-b8f8d6679aaa5f42.js" defer=""></script><script src="/_next/static/chunks/framework-114634acb84f8baa.js" defer=""></script><script src="/_next/static/chunks/main-f2ca60db2beb93ed.js" defer=""></script><script src="/_next/static/chunks/pages/_app-be51c38591acb686.js" defer=""></script><script src="/_next/static/chunks/542-7be5b5539309fe0b.js" defer=""></script><script src="/_next/static/chunks/210-aecf7644b6c77832.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bpathname%5D-5fe171a485dfba8b.js" defer=""></script><script src="/_next/static/NwEjpMHb8jAY4XF0V-9Qp/_buildManifest.js" defer=""></script><script src="/_next/static/NwEjpMHb8jAY4XF0V-9Qp/_ssgManifest.js" defer=""></script></head><body><div id="__next"><main><div class="text-color Layout_container__S4aNf" data-is-menu-open="false"><div class="SiteHeader_container__8tKwA" data-is-menu-open="false"><div class="SiteHeader_nav-container__oEq2d"><div class="SiteHeader_section-container__tAKnZ"><a class="SiteHeader_section-link__9DmFE interactive-color text-color" href="/blog/">blog</a><a class="SiteHeader_section-link__9DmFE interactive-color " href="/about/">about</a><a target="_blank" class="SiteHeader_section-link__9DmFE interactive-color" href="/blog/feed.xml">rss</a></div><button class="SiteHeader_menu-button__eK9ND">menu</button><a class="SiteHeader_publication-folio___ZFZS text-color" href="/">ASUKA WANG</a></div><div class="SiteHeader_divider__cq_R_ border-color-100"></div><div class="SiteHeader_menu-wrapper__2evr7"></div></div><div class="Layout_full-content__MQIxS"><div class="PostDetailPageHeader_container__fcMw9"><div class="Layout_main-content__mr9_2"><h1 class="PostDetailPageHeader_title__YwZEK">Dev Diary: Aura</h1><h2 class="PostDetailPageHeader_description__HSXhn">我嘗試了自己設計並實裝靈氣系統。它也許不顯眼，但絕不簡單。</h2><div class="PostDetailPageHeader_publish-date__pMF22">May 28, 2018</div></div></div></div><div class="Layout_main-content__mr9_2"><article class="PostDetailPage_article__K8T4B"><p>在最近進行的 side project 中刻了一個靈氣(aura)輪子。比我想像中的麻煩，決定動筆記錄一下。</p><p>首先，這是個規模很小的回合制遊戲，所有角色算攻防加權的動作可以塞在一個迴圈裡面。概念很簡單，我打算先算加權，然後再用加權套進攻防公式，而靈氣的部分就塞在加權裡一起處理。</p><p>這裡出現了第一個問題：回到剛剛說的「一個迴圈算完所有數字」，這導致了有些人的靈氣被套進加權時，應該被影響的對象已經先算完了。我也不想算每個人的攻防時再去抓一次所有角色所持有靈氣的判斷，效率感覺就很差。</p><p>所以我在每次行動決定後攻防開始前，先把靈氣註冊到該陣營的資料裡，如此就不用多從所有角色撈一次靈氣的資料，所有人都可以到固定的地方找靈氣。</p><p>就這樣很開心地開始跑了之後出現了第二個問題：由於系統設計上所有角色的加權都可能互相影響，每次算加權都會對每個角色計算一次。幾個角色行動就算幾次。所以靈氣的效果就被乘以人數。</p><p>我的解法是當靈氣啟動時算一次受影響目標，連帶的加權也在那時候就算完。靈氣的啟動與否會有很明顯的斷點(每次攻防結束都會斷掉，效果就被收回。開始時再啟動，這時再把效果加回去)。而原本的加權計算部分，從只計算靈氣的效果加上啟動與否的判斷。</p><p>就遊戲設計上來說靈氣是一個不好處理的東西。持續性的效果代表特效不會比一次性的技能顯目，但如此往往讓玩家低估了他實際的效果，同時設計者與玩家之間對靈氣在 lore 所扮演角色的沉浸感也常常有所歧異。</p><p>簡單地說，如果不是很花巧思的靈氣，你往往會覺得他很無聊。但這樣無聊的東西事實上花了比我想像還多的功夫，僅此紀錄一筆。</p><p>至於我把靈氣寫完之後發現太強所以拔掉就又是另一個故事了。</p></article><div class="PostDetailPage_additional-list-container__b_oHL"><div class="AdditionalPostList_container__ucjfo"><div class="AdditionalPostList_category-link__EDTWa">More from<a href="/blog/archive/?category=retrospective">retrospective</a></div><div class="AdditionalPostList_card-list__jz3F_"><a class="AdditionalPostList_card__doJcw" href="/blog/s14-recap/"><div><div class="AdditionalPostList_card-title__FDhSX">S14 Recap</div><div class="AdditionalPostList_card-description__Enc8v">I did not play a lot of league during 2024, but I had a few unforgettable moments nonetheless.</div></div><div class="AdditionalPostList_card-publish-date__Jvdgm">January 7, 2025</div></a><a class="AdditionalPostList_card__doJcw" href="/blog/site-patch-notes-2024-redesign/"><div><div class="AdditionalPostList_card-title__FDhSX">Site Patch Notes: 2024 Redesign</div><div class="AdditionalPostList_card-description__Enc8v">The 2024 redesign is finally here! I went on a journey of learning editorial design, and did an overhaul to this site's design, both functionality-wise and visual-wise.</div></div><div class="AdditionalPostList_card-publish-date__Jvdgm">August 18, 2024</div></a><a class="AdditionalPostList_card__doJcw" href="/blog/4-years-reflection/"><div><div class="AdditionalPostList_card-title__FDhSX">4 Years Reflection</div><div class="AdditionalPostList_card-description__Enc8v">Another two years of life as a full-time developer has passed. Many things changed and many lessons learned. It's a perfect timing to look back and reflect.</div></div><div class="AdditionalPostList_card-publish-date__Jvdgm">April 8, 2024</div></a><a class="AdditionalPostList_card__doJcw" href="/blog/s13-recap/"><div><div class="AdditionalPostList_card-title__FDhSX">S13 Recap</div><div class="AdditionalPostList_card-description__Enc8v">After a three years gap, I'm back to league.</div></div><div class="AdditionalPostList_card-publish-date__Jvdgm">January 23, 2024</div></a><a class="AdditionalPostList_card__doJcw" href="/blog/refactor-blog-2023-markdown-based-content/"><div><div class="AdditionalPostList_card-title__FDhSX">Refactor Blog 2023: Markdown Based Content</div><div class="AdditionalPostList_card-description__Enc8v">Embracing a different approach toward my own data, I made a change to the content hosting method of my blog.</div></div><div class="AdditionalPostList_card-publish-date__Jvdgm">June 19, 2023</div></a></div></div><div class="AdditionalPostList_container__ucjfo"><a class="AdditionalPostList_archive-link__7Q6ys" href="/blog/archive/">Archive</a><div class="AdditionalPostList_card-list__jz3F_"><a class="AdditionalPostList_card__doJcw" href="/blog/blogging-and-digital-gardening/"><div><div class="AdditionalPostList_card-title__FDhSX">Blogging and Digital Gardening in the Social Platform and Generative AI Era</div><div class="AdditionalPostList_card-description__Enc8v">I talk to myself about why bother writing at somewhere nobody comes.</div></div><div class="AdditionalPostList_card-publish-date__Jvdgm">February 11, 2025</div></a><a class="AdditionalPostList_card__doJcw" href="/blog/a-redemption-three-years-later/"><div><div class="AdditionalPostList_card-title__FDhSX">A Redemption Three Years Later</div><div class="AdditionalPostList_card-description__Enc8v">CD PROJEKT RED made a promise about Night City, which they broke. Three years later they had another attempt, and to me, it was their redemption.</div></div><div class="AdditionalPostList_card-publish-date__Jvdgm">January 13, 2025</div></a><a class="AdditionalPostList_card__doJcw" href="/blog/s14-recap/"><div><div class="AdditionalPostList_card-title__FDhSX">S14 Recap</div><div class="AdditionalPostList_card-description__Enc8v">I did not play a lot of league during 2024, but I had a few unforgettable moments nonetheless.</div></div><div class="AdditionalPostList_card-publish-date__Jvdgm">January 7, 2025</div></a><a class="AdditionalPostList_card__doJcw" href="/blog/thoughts-on-building-a-game-with-xstate/"><div><div class="AdditionalPostList_card-title__FDhSX">Thoughts on Building a Game with XState</div><div class="AdditionalPostList_card-description__Enc8v">After hearing about XState's good reputation for years, I used it to build the prototype for my game. These are my thoughts.</div></div><div class="AdditionalPostList_card-publish-date__Jvdgm">January 4, 2025</div></a><a class="AdditionalPostList_card__doJcw" href="/blog/under-the-hood-diablo-ii-item-generation/"><div><div class="AdditionalPostList_card-title__FDhSX">Under the Hood: Diablo II Item Generation</div><div class="AdditionalPostList_card-description__Enc8v">A system design research turned into a reconciliation with a game I didn't know I was so in love with, so I wrote a research note to express my appreciation.</div></div><div class="AdditionalPostList_card-publish-date__Jvdgm">November 8, 2024</div></a></div></div></div></div><div class="Layout_right-panel__zSn4t"></div><div class="SiteFooter_container__0v6cR border-color"><a href="https://asukawang.com" rel="noopener noreferrer" target="_blank" class="SiteFooter_link__RuMSe interactive-color">asukawang.com 2018-</a></div></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postContent":[{"type":"paragraph","children":[{"type":"plain","text":"在最近進行的 side project 中刻了一個靈氣(aura)輪子。比我想像中的麻煩，決定動筆記錄一下。"}]},{"type":"paragraph","children":[{"type":"plain","text":"首先，這是個規模很小的回合制遊戲，所有角色算攻防加權的動作可以塞在一個迴圈裡面。概念很簡單，我打算先算加權，然後再用加權套進攻防公式，而靈氣的部分就塞在加權裡一起處理。"}]},{"type":"paragraph","children":[{"type":"plain","text":"這裡出現了第一個問題：回到剛剛說的「一個迴圈算完所有數字」，這導致了有些人的靈氣被套進加權時，應該被影響的對象已經先算完了。我也不想算每個人的攻防時再去抓一次所有角色所持有靈氣的判斷，效率感覺就很差。"}]},{"type":"paragraph","children":[{"type":"plain","text":"所以我在每次行動決定後攻防開始前，先把靈氣註冊到該陣營的資料裡，如此就不用多從所有角色撈一次靈氣的資料，所有人都可以到固定的地方找靈氣。"}]},{"type":"paragraph","children":[{"type":"plain","text":"就這樣很開心地開始跑了之後出現了第二個問題：由於系統設計上所有角色的加權都可能互相影響，每次算加權都會對每個角色計算一次。幾個角色行動就算幾次。所以靈氣的效果就被乘以人數。"}]},{"type":"paragraph","children":[{"type":"plain","text":"我的解法是當靈氣啟動時算一次受影響目標，連帶的加權也在那時候就算完。靈氣的啟動與否會有很明顯的斷點(每次攻防結束都會斷掉，效果就被收回。開始時再啟動，這時再把效果加回去)。而原本的加權計算部分，從只計算靈氣的效果加上啟動與否的判斷。"}]},{"type":"paragraph","children":[{"type":"plain","text":"就遊戲設計上來說靈氣是一個不好處理的東西。持續性的效果代表特效不會比一次性的技能顯目，但如此往往讓玩家低估了他實際的效果，同時設計者與玩家之間對靈氣在 lore 所扮演角色的沉浸感也常常有所歧異。"}]},{"type":"paragraph","children":[{"type":"plain","text":"簡單地說，如果不是很花巧思的靈氣，你往往會覺得他很無聊。但這樣無聊的東西事實上花了比我想像還多的功夫，僅此紀錄一筆。"}]},{"type":"paragraph","children":[{"type":"plain","text":"至於我把靈氣寫完之後發現太強所以拔掉就又是另一個故事了。"}]}],"postMetadata":{"id":"dev-diary-aura","title":"Dev Diary: Aura","description":"我嘗試了自己設計並實裝靈氣系統。它也許不顯眼，但絕不簡單。","category":"retrospective","topic":"game development","tags":[],"publishDate":"2018-05-28","pathname":"dev-diary-aura"},"last5posts":[{"id":"blogging-and-digital-gardening","title":"Blogging and Digital Gardening in the Social Platform and Generative AI Era","description":"I talk to myself about why bother writing at somewhere nobody comes.","category":"essay","topic":"life","tags":[],"publishDate":"2025-02-11","pathname":"blogging-and-digital-gardening"},{"id":"a-redemption-three-years-later","title":"A Redemption Three Years Later","description":"CD PROJEKT RED made a promise about Night City, which they broke. Three years later they had another attempt, and to me, it was their redemption.","category":"review","topic":"gaming","tags":[],"publishDate":"2025-01-13","pathname":"a-redemption-three-years-later"},{"id":"s14-recap","title":"S14 Recap","description":"I did not play a lot of league during 2024, but I had a few unforgettable moments nonetheless.","category":"retrospective","topic":"gaming","tags":[],"publishDate":"2025-01-07","pathname":"s14-recap"},{"id":"thoughts-on-building-a-game-with-xstate","title":"Thoughts on Building a Game with XState","description":"After hearing about XState's good reputation for years, I used it to build the prototype for my game. These are my thoughts.","category":"note","topic":"game development","tags":[],"publishDate":"2025-01-04","pathname":"thoughts-on-building-a-game-with-xstate"},{"id":"under-the-hood-diablo-ii-item-generation","title":"Under the Hood: Diablo II Item Generation","description":"A system design research turned into a reconciliation with a game I didn't know I was so in love with, so I wrote a research note to express my appreciation.","category":"research","topic":"game development","tags":[],"publishDate":"2024-11-08","pathname":"under-the-hood-diablo-ii-item-generation"}],"categoryPosts":[{"id":"s14-recap","title":"S14 Recap","description":"I did not play a lot of league during 2024, but I had a few unforgettable moments nonetheless.","category":"retrospective","topic":"gaming","tags":[],"publishDate":"2025-01-07","pathname":"s14-recap"},{"id":"site-patch-notes-2024-redesign","title":"Site Patch Notes: 2024 Redesign","description":"The 2024 redesign is finally here! I went on a journey of learning editorial design, and did an overhaul to this site's design, both functionality-wise and visual-wise.","category":"retrospective","topic":"meta","tags":[],"publishDate":"2024-08-18","pathname":"site-patch-notes-2024-redesign"},{"id":"4-years-reflection","title":"4 Years Reflection","description":"Another two years of life as a full-time developer has passed. Many things changed and many lessons learned. It's a perfect timing to look back and reflect.","category":"retrospective","topic":"career","tags":[],"publishDate":"2024-04-08","pathname":"4-years-reflection"},{"id":"s13-recap","title":"S13 Recap","description":"After a three years gap, I'm back to league.","category":"retrospective","topic":"gaming","tags":[],"publishDate":"2024-01-23","pathname":"s13-recap"},{"id":"refactor-blog-2023-markdown-based-content","title":"Refactor Blog 2023: Markdown Based Content","description":"Embracing a different approach toward my own data, I made a change to the content hosting method of my blog.","category":"retrospective","topic":"meta","tags":[],"publishDate":"2023-06-19","pathname":"refactor-blog-2023-markdown-based-content"}],"categories":[{"name":"essay","count":12},{"name":"review","count":15},{"name":"retrospective","count":15},{"name":"note","count":9},{"name":"research","count":3}]},"__N_SSG":true},"page":"/blog/[pathname]","query":{"pathname":"dev-diary-aura"},"buildId":"NwEjpMHb8jAY4XF0V-9Qp","isFallback":false,"gsp":true,"scriptLoader":[]}</script><script>(function(){var el=document.createElement('link');el.href='/subfont/fallback-7029f17ef4.css';el.rel='stylesheet';document.body.appendChild(el)}())</script><noscript><link rel="stylesheet" href="/subfont/fallback-7029f17ef4.css"></noscript></body></html>
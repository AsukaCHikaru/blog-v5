<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Unity Dev Memo (2) | Asuka Wang</title><meta name="description" content="Asuka Wang&#x27;s blog"/><meta property="og:title" content="Unity Dev Memo (2) | Asuka Wang"/><meta property="twitter:title" content="Unity Dev Memo (2) | Asuka Wang"/><meta name="next-head-count" content="6"/><link rel="preconnect" href="/" crossorigin="anonymous"/><script id="theme-document" data-nscript="beforeInteractive">
        if (typeof window !== "undefined") {
          const savedTheme = localStorage.getItem("ASUKACHIKARU_THEME");
          const html = document.documentElement;
          const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches
            ? 'DARK'
            : 'LIGHT';
          if (savedTheme === "DARK" || systemTheme === "DARK") {
            html.classList.add('dark');
            html.style.backgroundColor = "#27211F";
          } else {
            html.classList.remove('dark');
            html.style.backgroundColor = "#F5F2E8";
          }
        }
      </script><link rel="preload" href="/_next/static/css/411e8f07e13c70fa.css" as="style"/><link rel="stylesheet" href="/_next/static/css/411e8f07e13c70fa.css" data-n-g=""/><link rel="preload" href="/_next/static/css/d8403707d10b0477.css" as="style"/><link rel="stylesheet" href="/_next/static/css/d8403707d10b0477.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-b8f8d6679aaa5f42.js" defer=""></script><script src="/_next/static/chunks/framework-114634acb84f8baa.js" defer=""></script><script src="/_next/static/chunks/main-f2ca60db2beb93ed.js" defer=""></script><script src="/_next/static/chunks/pages/_app-ba071d4eaf9a2c50.js" defer=""></script><script src="/_next/static/chunks/542-7be5b5539309fe0b.js" defer=""></script><script src="/_next/static/chunks/986-347b45c0cb7e6276.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bpathname%5D-25a78fdd03cb7e80.js" defer=""></script><script src="/_next/static/Ct-zOyv_Ohd6ncbBqnMnN/_buildManifest.js" defer=""></script><script src="/_next/static/Ct-zOyv_Ohd6ncbBqnMnN/_ssgManifest.js" defer=""></script></head><body><div id="__next"><main class="
        __variable_e0546c
        __variable_9d551b
        __variable_ef4fb7
        __variable_23fcf6
        __variable_6fb08b
        __variable_4de8ae
        font-serif"><div class="text-color"><div class="mx-fb2 lg:mx-auto max-w-[1280px]"><div class="mt-fb1 lg:mt-fb2"><div class="flex justify-end"><button class="font-noto-sans text-fb2 interactive-color">dark mode</button></div><div class="flex justify-between w-full mt-fb8 mb-fb2"><div class="w-fit flex flex-col lg:flex-row gap-fb1 lg:gap-fb3"><a class="text-fb2 lg:text-fb3 leading-fb3 lg:leading-fb5 interactive-color text-color" href="/blog/">BLOG</a><a class="text-fb2 lg:text-fb3 leading-fb3 lg:leading-fb5 interactive-color " href="/about/">ABOUT</a></div><a class="text-fb3 lg:text-fb5 leading-none font-abhaya-libre font-bold" href="/">ASUKA WANG</a></div><div class="mb-fb2 lg:mb-fb3 border-t-2 border-b h-2 border-color-100"></div></div><div><div class="flex flex-col gap-fb1 mb-fb5 lg:mb-fb8"><h1 class="text-fb8 lg:text-fb13 font-abril leading-none">UNITY DEV MEMO (2)</h1><div class="text-fb2 lg:text-fb3 font-noto-sans">October 4, 2020</div></div><div class="w-full grid grid-cols-4 gap-fb3"><div class="col-span-4 lg:col-span-3"><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><h3 class="mt-8 text-xl lg:text-3xl font-semibold" id="Raycast"><span>Raycast</span></h3></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><span>在使用滑鼠的 3D 遊戲中，幾乎與任何物件互動都需要使用滑鼠，判斷玩家游標的位置自然是非常重要且基礎的技術。然而相對 3D 世界的三維座標，存在於螢幕上的游標只有二維座標的 X 軸與 Y 軸兩個數據代表位置，這使得在遊戲世界中精準定位游標位置變得困難。</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><span>不過，大多數想要在遊戲中取得游標位置時，都是為了與存在該位置的物件互動。這個物件就能成為定位游標的輔助工具，只要計算從玩家視角中的游標，是否真正與遊戲世界中的該物件重合即可。</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><span>具體來說，這個判斷方式是從攝影機朝向滑鼠的二維座標射出一道直線，並判斷該射線所相交的物件。</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><h4 class="mt-8 text-lg lg:text-2xl font-semibold" id="Plane.Raycast"><span>Plane.Raycast</span></h4></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><span>先從這個技術的最基本實作，也就是判斷滑鼠在純平面上的座標開始。</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><pre class="my-6 border rounded-md text-base leading-4"><code class="font-courier language-csharp rounded-md">using UnityEngine;

public class GetMousePos : MonoBehaviour {
    Plane plane = new Plane (Vector3.up, 0);
    Camera camera;
    Vector3 mousePos;

    void Start () {
        camera = Camera.main; 
    }

    void Update () {
        float distance;
        Ray ray = camera.ScreenPointToRay(Input.mousePosition);
        if(plane.Raycast(ray, out distance)){
            mousePos = ray.GetPoint(distance);
        }
    }
}</code></pre></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><span>一行一行解讀：</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><pre class="my-6 border rounded-md text-base leading-4"><code class="font-courier language-csharp rounded-md">Plane plane = new Plane (Vector3.up, 0);</code></pre></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><span>從官方文件 </span><a href="https://docs.unity3d.com/ScriptReference/Plane-ctor.html" class="text-blue-400 underline" rel="noreferrer noopener" target="_blank">https://docs.unity3d.com/ScriptReference/Plane-ctor.html</a><span> 可以查到 Plane 的 constructor 是長這樣： </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">Plane (Vector3 inNormal, float distance)</code><span> 。</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><span>以三維座標 (0, 0, 0) 為基準點，基於法線方向 </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">inNormal</code><span> 在距離基準點 </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">distance</code><span> 的位置創造一個平面。 </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">Vector3.up</code><span> 就等於 </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">Vector3 (0, 1, 0)</code><span> ，也就是筆直朝向 Y軸上方的向量。這個 plane 不會顯示在遊戲中，如果想要用視覺理解 plane 的概念，可以直接在 Editor 中新增一個 rotation 與 position 都為 (0, 0, 0) 的 Plane，這兩個平面基本上相同。</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><pre class="my-6 border rounded-md text-base leading-4"><code class="font-courier language-csharp rounded-md">   Camera camera;
   Vector3 mousePos;
   void Start () {
       camera = Camera.main; 
   }</code></pre></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><span>將目前使用的主攝影機存為變數，並預先設立儲存滑鼠位置用的變數。</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><pre class="my-6 border rounded-md text-base leading-4"><code class="font-courier language-csharp rounded-md">void Update () {
    float distance;
    Ray ray = camera.ScreenPointToRay(Input.mousePosition);
    ...</code></pre></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><span>在每次更新時，創建一個空的距離變數 </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">distance</code><span> ，以及一個射線變數 </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">ray</code><span> ，起點為攝影機的 near clipping plane，方向為滑鼠位置。</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><span>攝影機的顯示範圍是一個上窄下寬的梯形，頂部距離攝影機較近且面積較小的平面就是 near clipping plane，底部較遠較大的平面就是 far clipping plane。玩家所謂的遊戲視窗大小基本上就等於 near clipping plane， </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">Camera.ScreenPointToRay</code><span> 也就是從 near clipping plane 射向 far clipping plane。</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><img alt="" src="[unity-dev-memo-1_1.png]" width="500" height="500" decoding="async" data-nimg="1" class="mx-auto px-4 py-2" loading="lazy" style="color:transparent"/></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><span>這兩個數值都可以從 camera 的 inspector 調整。</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><img alt="" src="[unity-dev-memo-1_2.png]" width="500" height="500" decoding="async" data-nimg="1" class="mx-auto px-4 py-2" loading="lazy" style="color:transparent"/></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><pre class="my-6 border rounded-md text-base leading-4"><code class="font-courier language-csharp rounded-md">		... 
		if(plane.Raycast(ray, out distance)){
        mousePos = ray.GetPoint(distance);
    }
}</code></pre></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><span>回到程式碼， </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">plane.Raycast</code><span> 中的 </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">out</code><span> 是另一個值得注意的地方。先看 </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">plane.Raycast</code><span> 函數本身：</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><a href="https://docs.unity3d.com/ScriptReference/Plane.Raycast.html" class="text-blue-400 underline" rel="noreferrer noopener" target="_blank">https://docs.unity3d.com/ScriptReference/Plane.Raycast.html</a></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><span>這個函數的型別是 bool ，回傳引數 ray 是否與該 plane 相交。然而，部分函數提供額外的回傳值，取得值時必須提供一個空變數與 </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">out</code><span> 關鍵字一起作為引數輸入。 </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">plane.Raycast</code><span> 就是有提供 </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">out</code><span> 回傳值的函數之一，提供的是當相交發生時從 ray 起點至相交點的距離 </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">distance</code><span> 。因此這一段程式碼的作用是，判斷平面 plane 與 ray 是否有相交發生，如果有的話將距離儲存進 distance。現在射線起點，相交距離都知道了，就能計算出滑鼠位置便是從該射線上從起點開始距離 distance 的地方。</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><img alt="" src="[unity-dev-memo-2_3.gif]" width="500" height="500" decoding="async" data-nimg="1" class="mx-auto px-4 py-2" loading="lazy" style="color:transparent"/></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><span>以上就是在射線上增加元素使其可視化之後的展示，紅色點是射線起點 (</span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">ray.GetPoint(0)</code><span> )，藍色點是與平面相交點（ </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">ray.GetPoint(distance)</code><span> ）。可以看見起點不是攝影機本身，而是在 near clipping plane 上。</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><h4 class="mt-8 text-lg lg:text-2xl font-semibold" id="Collider.Raycast"><span>Collider.Raycast</span></h4></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><span>以上都是純平面的情況，實際在遊戲中常常有地形非單純平面的情況，此時可以使用 </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">TerrainCollider</code><span> 來計算射線與地形 terrain 的相交點。</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><pre class="my-6 border rounded-md text-base leading-4"><code class="font-courier language-csharp rounded-md">using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class GetMousePos : MonoBehaviour {
    TerrainCollider terrainCollider;
    Camera camera;
    Vector3 mousePos;

    void Start () {
        camera = Camera.main;        
        terrainCollider = Terrain.activeTerrain.GetComponent&lt;TerrainCollider&gt;();
    }

    void Update () {
        Ray ray = camera.ScreenPointToRay(Input.mousePosition);
        RaycastHit hitData;
        if(terrainCollider.Raycast(ray, out hitData, 1000)){
            mousePos = hitData.point;
        }
    }
}</code></pre></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><span>內容大致相同，只是這次判斷相交點的元素不是平面，而是地形碰撞體 </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">terrainCollider</code><span> ，而這個函數所提供的 out 相交資料也更豐富，不只有距離，而是一整個資料形態 RaycastHit </span><a href="https://docs.unity3d.com/ScriptReference/RaycastHit.html" class="text-blue-400 underline" rel="noreferrer noopener" target="_blank">https://docs.unity3d.com/ScriptReference/RaycastHit.html</a><span> ，包含 point, distance ,collider等，point 即為射線與 </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">terrainCollider</code><span> 相交點。</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><img alt="" src="[unity-dev-memo-2_4.gif]" width="500" height="500" decoding="async" data-nimg="1" class="mx-auto px-4 py-2" loading="lazy" style="color:transparent"/></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><span>上圖就是在不規則地形使用 </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">terrainCollider.Raycast</code><span> 追蹤游標位置的展示，可以看見在右側遊戲畫面中游標移至山脈可見的南側時，左側的編輯器畫面也顯示游標位置的藍點直接跳過山脈北側，同時隨著地形一同起伏。</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><h4 class="mt-8 text-lg lg:text-2xl font-semibold" id="Physics.Raycast"><span>Physics.Raycast</span></h4></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><span>以上兩種實作的前提都是射線相交的對象為特定單一物件。想要判斷射線是否相交非特定物件時，使用 </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">Physics.Raycast</code><span> 。這個函數會抓取引數的射線相交的第一個對象，且同樣提供 </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">out RaycastHit</code><span> 資料。</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><pre class="my-6 border rounded-md text-base leading-4"><code class="font-courier language-csharp rounded-md">using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class GetMousePos : MonoBehaviour {
    Camera camera;
    Vector3 mousePos;

    void Start () {
        camera = Camera.main;
    }

    void Update () {
        Ray ray = camera.ScreenPointToRay(Input.mousePosition);
        RaycastHit hitData;
        if(Physics.Raycast(ray, out hitData, 1000)){
            mousePos = hitData.point;
						GameObject hitObj = hitData.collider.transform.gameObject;
        }
    }
}</code></pre></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">Physics.Raycast</code><span> 的提供距離引數做為判斷相交的最大距離，可以依照自己需求設定。</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><img alt="" src="[unity-dev-memo-2_5 1.gif]" width="500" height="500" decoding="async" data-nimg="1" class="mx-auto px-4 py-2" loading="lazy" style="color:transparent"/></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><span>上圖為使用 </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">Physics.Raycast</code><span> 追蹤游標互動物件的展示，使用 </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">RaycastHit.collider.transform.GameObject</code><span> 判斷射線的碰撞體的原物件之後就可以進行互動。</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><h4 class="mt-8 text-lg lg:text-2xl font-semibold" id="LayerMask-in-Physics.Raycast"><span>LayerMask in Physics.Raycast</span></h4></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">Physics.Raycast</code><span> 還提供圖層引數過濾判斷射線相交對象。</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><pre class="my-6 border rounded-md text-base leading-4"><code class="font-courier language-csharp rounded-md">using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class HighlightRayOrigin : MonoBehaviour {
    Camera camera;
    Vector3 mousePos;
    LayerMask layerMask = 1 &lt;&lt; 8;

    void Start () {
        camera = Camera.main;
    }

    void Update () {
        Ray ray = camera.ScreenPointToRay (Input.mousePosition);
        RaycastHit hitData;
        if (Physics.Raycast (ray, out hitData, 1000, layerMask)) {
            mousePos = hitData.point;            
						GameObject hitObj = hitData.collider.transform.gameObject;
        }
    }
}</code></pre></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">Physics.Raycast</code><span> 的 </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">layerMask</code><span> 引數就是指定圖層，只有在這個圖層中的物件才會觸發與射線相交的判斷。</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><span>請注意，雖然這個引數的型別是 int，但其實是二進制的 int，所以直接輸入在編輯器中顯示的圖層編號是不會正常運作的，必須以 </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">&lt;&lt;</code><span> 運算子將指定編號以二進制方式儲存在變數中再傳遞給 </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">Physics.Raycast</code><span> 函數。</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><img alt="" src="[unity-dev-memo-2_6.gif]" width="500" height="500" decoding="async" data-nimg="1" class="mx-auto px-4 py-2" loading="lazy" style="color:transparent"/></div><div class="mb-6 text-lg lg:text-xl lg:leading-8 last:mb-0"><span>上圖是使用 LayerMask 過濾可互動物件的展示，只有上層物件位於可互動的圖層中，因此游標在地形或是下層物件時藍點都不會隨之移動。</span></div></div><div class="flex-col justify-between hidden lg:flex"><div class="flex flex-col gap-fb5"><div><div class="text-fb3 py-fb1 mb-fb3 border-t border-b border-color text-center font-noto-sans font-extralight">TABLE OF CONTENT</div><ul class="ml-fb3 list-outside list-disc interactive-list-color"><li class="mt-fb2"><div class="w-fb2"></div><a class="font-serif text-fb3 leading-none interactive-color" href="/blog/[pathname]/#Raycast">Raycast</a></li><li class="mt-fb2"><div class="w-fb2"></div><div class="w-fb2"></div><a class="font-serif text-fb3 leading-none interactive-color" href="/blog/[pathname]/#Plane.Raycast">Plane.Raycast</a></li><li class="mt-fb2"><div class="w-fb2"></div><div class="w-fb2"></div><a class="font-serif text-fb3 leading-none interactive-color" href="/blog/[pathname]/#Collider.Raycast">Collider.Raycast</a></li><li class="mt-fb2"><div class="w-fb2"></div><div class="w-fb2"></div><a class="font-serif text-fb3 leading-none interactive-color" href="/blog/[pathname]/#Physics.Raycast">Physics.Raycast</a></li><li class="mt-fb2"><div class="w-fb2"></div><div class="w-fb2"></div><a class="font-serif text-fb3 leading-none interactive-color" href="/blog/[pathname]/#LayerMask-in-Physics.Raycast">LayerMask in Physics.Raycast</a></li></ul></div><div><div class="text-fb3 py-fb1 mb-fb3 border-t border-b border-color text-center font-noto-sans font-extralight">ARCHIVE</div><div class="flex flex-col gap-fb3"><a class=" flex flex-col gap-fb1 interactive-color pb-fb2 border-b border-color last-of-type:border-none last-of-type:pb-0 lg:pb-0 lg:border-none " href="/blog/godot-essentials/"><div class="text-fb5 lg:text-fb3 font-abril leading-none text-wrap-balance">Godot Essentials</div><div class="text-fb3 lg:text-fb3 font-gentium-basic leading-none">The biggest lessons I learned in my first Godot project.</div><div class="text-fb2 leading-none font-noto-sans">April 21, 2024</div></a><a class=" flex flex-col gap-fb1 interactive-color pb-fb2 border-b border-color last-of-type:border-none last-of-type:pb-0 lg:pb-0 lg:border-none " href="/blog/4-years-reflection/"><div class="text-fb5 lg:text-fb3 font-abril leading-none text-wrap-balance">4 Years Reflection</div><div class="text-fb3 lg:text-fb3 font-gentium-basic leading-none">Another two years of life as a full-time developer has passed. Many things changed and many lessons learned. It&#x27;s a perfect timing to look back and reflect.</div><div class="text-fb2 leading-none font-noto-sans">April 8, 2024</div></a><a class=" flex flex-col gap-fb1 interactive-color pb-fb2 border-b border-color last-of-type:border-none last-of-type:pb-0 lg:pb-0 lg:border-none " href="/blog/improving-greatness/"><div class="text-fb5 lg:text-fb3 font-abril leading-none text-wrap-balance">Improving Greatness</div><div class="text-fb3 lg:text-fb3 font-gentium-basic leading-none">Breath of the Wild is one of the most impactful game in last decade. Yet for its successor, Nintendo built an even more polished version on an already magnificent fundamental.</div><div class="text-fb2 leading-none font-noto-sans">March 17, 2024</div></a><a class=" flex flex-col gap-fb1 interactive-color pb-fb2 border-b border-color last-of-type:border-none last-of-type:pb-0 lg:pb-0 lg:border-none " href="/blog/s13-recap/"><div class="text-fb5 lg:text-fb3 font-abril leading-none text-wrap-balance">S13 Recap</div><div class="text-fb3 lg:text-fb3 font-gentium-basic leading-none">After a three years gap, I&#x27;m back to league.</div><div class="text-fb2 leading-none font-noto-sans">January 23, 2024</div></a><a class=" flex flex-col gap-fb1 interactive-color pb-fb2 border-b border-color last-of-type:border-none last-of-type:pb-0 lg:pb-0 lg:border-none " href="/blog/refactor-blog-2023-markdown-based-content/"><div class="text-fb5 lg:text-fb3 font-abril leading-none text-wrap-balance">Refactor Blog 2023: Markdown Based Content</div><div class="text-fb3 lg:text-fb3 font-gentium-basic leading-none">Embracing a different approach toward my own data, I made a change to the content hosting method of my blog.</div><div class="text-fb2 leading-none font-noto-sans">June 19, 2023</div></a><div><a class="flex items-end lg:justify-end" href="/blog/archive/"><span class="font-noto-sans text-fb3 leading-none interactive-color">FULL LIST</span></a></div></div></div><div><div class="text-fb3 py-fb1 mb-fb3 border-t border-b border-color text-center font-noto-sans font-extralight">CATEGORY</div><div class="flex flex-col gap-fb2 lg:border-l-2 border-color lg:pl-fb2"><div><a class="flex leading-fb3 items-end interactive-color" href="/blog/archive/?category=Gaming"><span class="text-fb3 font-alegreya">Gaming</span><span class="mx-fb1 flex-grow border-b border-dashed border-color"></span><span class="text-fb3 font-noto-sans">12</span><span class="ml-fb1 text-fb2 font-noto-sans leading-none">POST<!-- -->S</span></a></div><div><a class="flex leading-fb3 items-end interactive-color" href="/blog/archive/?category=League%20of%20Legends"><span class="text-fb3 font-alegreya">League of Legends</span><span class="mx-fb1 flex-grow border-b border-dashed border-color"></span><span class="text-fb3 font-noto-sans">8</span><span class="ml-fb1 text-fb2 font-noto-sans leading-none">POST<!-- -->S</span></a></div><div><a class="flex leading-fb3 items-end interactive-color" href="/blog/archive/?category=Game%20Development"><span class="text-fb3 font-alegreya">Game Development</span><span class="mx-fb1 flex-grow border-b border-dashed border-color"></span><span class="text-fb3 font-noto-sans">5</span><span class="ml-fb1 text-fb2 font-noto-sans leading-none">POST<!-- -->S</span></a></div><div><a class="flex leading-fb3 items-end interactive-color" href="/blog/archive/?category=Life"><span class="text-fb3 font-alegreya">Life</span><span class="mx-fb1 flex-grow border-b border-dashed border-color"></span><span class="text-fb3 font-noto-sans">5</span><span class="ml-fb1 text-fb2 font-noto-sans leading-none">POST<!-- -->S</span></a></div><div><a class="flex leading-fb3 items-end interactive-color" href="/blog/archive/?category=Meta"><span class="text-fb3 font-alegreya">Meta</span><span class="mx-fb1 flex-grow border-b border-dashed border-color"></span><span class="text-fb3 font-noto-sans">4</span><span class="ml-fb1 text-fb2 font-noto-sans leading-none">POST<!-- -->S</span></a></div><div><a class="flex leading-fb3 items-end interactive-color" href="/blog/archive/?category=Web%20Development"><span class="text-fb3 font-alegreya">Web Development</span><span class="mx-fb1 flex-grow border-b border-dashed border-color"></span><span class="text-fb3 font-noto-sans">4</span><span class="ml-fb1 text-fb2 font-noto-sans leading-none">POST<!-- -->S</span></a></div><div><a class="flex leading-fb3 items-end interactive-color" href="/blog/archive/?category=HKT48"><span class="text-fb3 font-alegreya">HKT48</span><span class="mx-fb1 flex-grow border-b border-dashed border-color"></span><span class="text-fb3 font-noto-sans">4</span><span class="ml-fb1 text-fb2 font-noto-sans leading-none">POST<!-- -->S</span></a></div><div><a class="flex leading-fb3 items-end interactive-color" href="/blog/archive/?category=Programming"><span class="text-fb3 font-alegreya">Programming</span><span class="mx-fb1 flex-grow border-b border-dashed border-color"></span><span class="text-fb3 font-noto-sans">3</span><span class="ml-fb1 text-fb2 font-noto-sans leading-none">POST<!-- -->S</span></a></div><div><a class="flex leading-fb3 items-end interactive-color" href="/blog/archive/?category=Movie"><span class="text-fb3 font-alegreya">Movie</span><span class="mx-fb1 flex-grow border-b border-dashed border-color"></span><span class="text-fb3 font-noto-sans">2</span><span class="ml-fb1 text-fb2 font-noto-sans leading-none">POST<!-- -->S</span></a></div></div></div></div><div class="self-end mt-fb5"><button class="font-noto-sans text-fb3 interactive-color">TOP</button></div></div><div class="lg:hidden col-span-4 flex flex-col gap-fb3"><div class="mt-fb5 mb-fb2 border border-color"></div><div class="px-fb2"><div class="flex gap-fb2 mb-fb1"><div class="flex-grow my-auto border-t border-b border-color h-[3px]"></div><div class="font-noto-sans text-fb2 font-thin">ARCHIVE</div><div class="flex-grow my-auto border-t border-b border-color h-[3px]"></div></div><div class="flex flex-col gap-fb3"><a class=" flex flex-col gap-fb1 interactive-color pb-fb2 border-b border-color last-of-type:border-none last-of-type:pb-0 lg:pb-0 lg:border-none " href="/blog/godot-essentials/"><div class="text-fb5 lg:text-fb3 font-abril leading-none text-wrap-balance">Godot Essentials</div><div class="text-fb3 lg:text-fb3 font-gentium-basic leading-none">The biggest lessons I learned in my first Godot project.</div><div class="text-fb2 leading-none font-noto-sans">April 21, 2024</div></a><a class=" flex flex-col gap-fb1 interactive-color pb-fb2 border-b border-color last-of-type:border-none last-of-type:pb-0 lg:pb-0 lg:border-none " href="/blog/4-years-reflection/"><div class="text-fb5 lg:text-fb3 font-abril leading-none text-wrap-balance">4 Years Reflection</div><div class="text-fb3 lg:text-fb3 font-gentium-basic leading-none">Another two years of life as a full-time developer has passed. Many things changed and many lessons learned. It&#x27;s a perfect timing to look back and reflect.</div><div class="text-fb2 leading-none font-noto-sans">April 8, 2024</div></a><a class=" flex flex-col gap-fb1 interactive-color pb-fb2 border-b border-color last-of-type:border-none last-of-type:pb-0 lg:pb-0 lg:border-none " href="/blog/improving-greatness/"><div class="text-fb5 lg:text-fb3 font-abril leading-none text-wrap-balance">Improving Greatness</div><div class="text-fb3 lg:text-fb3 font-gentium-basic leading-none">Breath of the Wild is one of the most impactful game in last decade. Yet for its successor, Nintendo built an even more polished version on an already magnificent fundamental.</div><div class="text-fb2 leading-none font-noto-sans">March 17, 2024</div></a><a class=" flex flex-col gap-fb1 interactive-color pb-fb2 border-b border-color last-of-type:border-none last-of-type:pb-0 lg:pb-0 lg:border-none " href="/blog/s13-recap/"><div class="text-fb5 lg:text-fb3 font-abril leading-none text-wrap-balance">S13 Recap</div><div class="text-fb3 lg:text-fb3 font-gentium-basic leading-none">After a three years gap, I&#x27;m back to league.</div><div class="text-fb2 leading-none font-noto-sans">January 23, 2024</div></a><a class=" flex flex-col gap-fb1 interactive-color pb-fb2 border-b border-color last-of-type:border-none last-of-type:pb-0 lg:pb-0 lg:border-none " href="/blog/refactor-blog-2023-markdown-based-content/"><div class="text-fb5 lg:text-fb3 font-abril leading-none text-wrap-balance">Refactor Blog 2023: Markdown Based Content</div><div class="text-fb3 lg:text-fb3 font-gentium-basic leading-none">Embracing a different approach toward my own data, I made a change to the content hosting method of my blog.</div><div class="text-fb2 leading-none font-noto-sans">June 19, 2023</div></a><div><a class="flex items-end lg:justify-end" href="/blog/archive/"><span class="font-noto-sans text-fb3 leading-none interactive-color">FULL LIST</span></a></div></div></div><div class="px-fb2"><div class="flex gap-fb2 mb-fb1"><div class="flex-grow my-auto border-t border-b border-color h-[3px]"></div><div class="font-noto-sans text-fb2 font-thin">CATEGORY</div><div class="flex-grow my-auto border-t border-b border-color h-[3px]"></div></div><div class="flex flex-col gap-fb2 lg:border-l-2 border-color lg:pl-fb2"><div><a class="flex leading-fb3 items-end interactive-color" href="/blog/archive/?category=Gaming"><span class="text-fb3 font-alegreya">Gaming</span><span class="mx-fb1 flex-grow border-b border-dashed border-color"></span><span class="text-fb3 font-noto-sans">12</span><span class="ml-fb1 text-fb2 font-noto-sans leading-none">POST<!-- -->S</span></a></div><div><a class="flex leading-fb3 items-end interactive-color" href="/blog/archive/?category=League%20of%20Legends"><span class="text-fb3 font-alegreya">League of Legends</span><span class="mx-fb1 flex-grow border-b border-dashed border-color"></span><span class="text-fb3 font-noto-sans">8</span><span class="ml-fb1 text-fb2 font-noto-sans leading-none">POST<!-- -->S</span></a></div><div><a class="flex leading-fb3 items-end interactive-color" href="/blog/archive/?category=Game%20Development"><span class="text-fb3 font-alegreya">Game Development</span><span class="mx-fb1 flex-grow border-b border-dashed border-color"></span><span class="text-fb3 font-noto-sans">5</span><span class="ml-fb1 text-fb2 font-noto-sans leading-none">POST<!-- -->S</span></a></div><div><a class="flex leading-fb3 items-end interactive-color" href="/blog/archive/?category=Life"><span class="text-fb3 font-alegreya">Life</span><span class="mx-fb1 flex-grow border-b border-dashed border-color"></span><span class="text-fb3 font-noto-sans">5</span><span class="ml-fb1 text-fb2 font-noto-sans leading-none">POST<!-- -->S</span></a></div><div><a class="flex leading-fb3 items-end interactive-color" href="/blog/archive/?category=Meta"><span class="text-fb3 font-alegreya">Meta</span><span class="mx-fb1 flex-grow border-b border-dashed border-color"></span><span class="text-fb3 font-noto-sans">4</span><span class="ml-fb1 text-fb2 font-noto-sans leading-none">POST<!-- -->S</span></a></div><div><a class="flex leading-fb3 items-end interactive-color" href="/blog/archive/?category=Web%20Development"><span class="text-fb3 font-alegreya">Web Development</span><span class="mx-fb1 flex-grow border-b border-dashed border-color"></span><span class="text-fb3 font-noto-sans">4</span><span class="ml-fb1 text-fb2 font-noto-sans leading-none">POST<!-- -->S</span></a></div><div><a class="flex leading-fb3 items-end interactive-color" href="/blog/archive/?category=HKT48"><span class="text-fb3 font-alegreya">HKT48</span><span class="mx-fb1 flex-grow border-b border-dashed border-color"></span><span class="text-fb3 font-noto-sans">4</span><span class="ml-fb1 text-fb2 font-noto-sans leading-none">POST<!-- -->S</span></a></div><div><a class="flex leading-fb3 items-end interactive-color" href="/blog/archive/?category=Programming"><span class="text-fb3 font-alegreya">Programming</span><span class="mx-fb1 flex-grow border-b border-dashed border-color"></span><span class="text-fb3 font-noto-sans">3</span><span class="ml-fb1 text-fb2 font-noto-sans leading-none">POST<!-- -->S</span></a></div><div><a class="flex leading-fb3 items-end interactive-color" href="/blog/archive/?category=Movie"><span class="text-fb3 font-alegreya">Movie</span><span class="mx-fb1 flex-grow border-b border-dashed border-color"></span><span class="text-fb3 font-noto-sans">2</span><span class="ml-fb1 text-fb2 font-noto-sans leading-none">POST<!-- -->S</span></a></div></div></div></div></div></div><div class="mt-fb8 pt-fb2 mb-fb8 text-center lg:text-left font-noto-sans interactive-color border-t border-color"><a href="https://asukachikaru.com" rel="noopener noreferrer" target="_blank" class="text-fb2">asukachikaru.com</a> <!-- -->2018-</div></div></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postContent":[{"type":"heading","children":[{"type":"plain","text":"Raycast"}],"depth":2},{"type":"paragraph","children":[{"type":"plain","text":"在使用滑鼠的 3D 遊戲中，幾乎與任何物件互動都需要使用滑鼠，判斷玩家游標的位置自然是非常重要且基礎的技術。然而相對 3D 世界的三維座標，存在於螢幕上的游標只有二維座標的 X 軸與 Y 軸兩個數據代表位置，這使得在遊戲世界中精準定位游標位置變得困難。"}]},{"type":"paragraph","children":[{"type":"plain","text":"不過，大多數想要在遊戲中取得游標位置時，都是為了與存在該位置的物件互動。這個物件就能成為定位游標的輔助工具，只要計算從玩家視角中的游標，是否真正與遊戲世界中的該物件重合即可。"}]},{"type":"paragraph","children":[{"type":"plain","text":"具體來說，這個判斷方式是從攝影機朝向滑鼠的二維座標射出一道直線，並判斷該射線所相交的物件。"}]},{"type":"heading","children":[{"type":"plain","text":"Plane.Raycast"}],"depth":3},{"type":"paragraph","children":[{"type":"plain","text":"先從這個技術的最基本實作，也就是判斷滑鼠在純平面上的座標開始。"}]},{"type":"code","lang":"csharp","text":"using UnityEngine;\n\npublic class GetMousePos : MonoBehaviour {\n    Plane plane = new Plane (Vector3.up, 0);\n    Camera camera;\n    Vector3 mousePos;\n\n    void Start () {\n        camera = Camera.main; \n    }\n\n    void Update () {\n        float distance;\n        Ray ray = camera.ScreenPointToRay(Input.mousePosition);\n        if(plane.Raycast(ray, out distance)){\n            mousePos = ray.GetPoint(distance);\n        }\n    }\n}"},{"type":"paragraph","children":[{"type":"plain","text":"一行一行解讀："}]},{"type":"code","lang":"csharp","text":"Plane plane = new Plane (Vector3.up, 0);"},{"type":"paragraph","children":[{"type":"plain","text":"從官方文件 "},{"type":"link","text":"https://docs.unity3d.com/ScriptReference/Plane-ctor.html","url":"https://docs.unity3d.com/ScriptReference/Plane-ctor.html"},{"type":"plain","text":" 可以查到 Plane 的 constructor 是長這樣： "},{"type":"inlineCode","text":"Plane (Vector3 inNormal, float distance)"},{"type":"plain","text":" 。"}]},{"type":"paragraph","children":[{"type":"plain","text":"以三維座標 (0, 0, 0) 為基準點，基於法線方向 "},{"type":"inlineCode","text":"inNormal"},{"type":"plain","text":" 在距離基準點 "},{"type":"inlineCode","text":"distance"},{"type":"plain","text":" 的位置創造一個平面。 "},{"type":"inlineCode","text":"Vector3.up"},{"type":"plain","text":" 就等於 "},{"type":"inlineCode","text":"Vector3 (0, 1, 0)"},{"type":"plain","text":" ，也就是筆直朝向 Y軸上方的向量。這個 plane 不會顯示在遊戲中，如果想要用視覺理解 plane 的概念，可以直接在 Editor 中新增一個 rotation 與 position 都為 (0, 0, 0) 的 Plane，這兩個平面基本上相同。"}]},{"type":"code","lang":"csharp","text":"   Camera camera;\n   Vector3 mousePos;\n   void Start () {\n       camera = Camera.main; \n   }"},{"type":"paragraph","children":[{"type":"plain","text":"將目前使用的主攝影機存為變數，並預先設立儲存滑鼠位置用的變數。"}]},{"type":"code","lang":"csharp","text":"void Update () {\n    float distance;\n    Ray ray = camera.ScreenPointToRay(Input.mousePosition);\n    ..."},{"type":"paragraph","children":[{"type":"plain","text":"在每次更新時，創建一個空的距離變數 "},{"type":"inlineCode","text":"distance"},{"type":"plain","text":" ，以及一個射線變數 "},{"type":"inlineCode","text":"ray"},{"type":"plain","text":" ，起點為攝影機的 near clipping plane，方向為滑鼠位置。"}]},{"type":"paragraph","children":[{"type":"plain","text":"攝影機的顯示範圍是一個上窄下寬的梯形，頂部距離攝影機較近且面積較小的平面就是 near clipping plane，底部較遠較大的平面就是 far clipping plane。玩家所謂的遊戲視窗大小基本上就等於 near clipping plane， "},{"type":"inlineCode","text":"Camera.ScreenPointToRay"},{"type":"plain","text":" 也就是從 near clipping plane 射向 far clipping plane。"}]},{"type":"paragraph","children":[{"type":"plain","text":"![[unity-dev-memo-1_1.png]]"}]},{"type":"paragraph","children":[{"type":"plain","text":"這兩個數值都可以從 camera 的 inspector 調整。"}]},{"type":"paragraph","children":[{"type":"plain","text":"![[unity-dev-memo-1_2.png]]"}]},{"type":"code","lang":"csharp","text":"\t\t... \n\t\tif(plane.Raycast(ray, out distance)){\n        mousePos = ray.GetPoint(distance);\n    }\n}"},{"type":"paragraph","children":[{"type":"plain","text":"回到程式碼， "},{"type":"inlineCode","text":"plane.Raycast"},{"type":"plain","text":" 中的 "},{"type":"inlineCode","text":"out"},{"type":"plain","text":" 是另一個值得注意的地方。先看 "},{"type":"inlineCode","text":"plane.Raycast"},{"type":"plain","text":" 函數本身："}]},{"type":"paragraph","children":[{"type":"link","text":"https://docs.unity3d.com/ScriptReference/Plane.Raycast.html","url":"https://docs.unity3d.com/ScriptReference/Plane.Raycast.html"}]},{"type":"paragraph","children":[{"type":"plain","text":"這個函數的型別是 bool ，回傳引數 ray 是否與該 plane 相交。然而，部分函數提供額外的回傳值，取得值時必須提供一個空變數與 "},{"type":"inlineCode","text":"out"},{"type":"plain","text":" 關鍵字一起作為引數輸入。 "},{"type":"inlineCode","text":"plane.Raycast"},{"type":"plain","text":" 就是有提供 "},{"type":"inlineCode","text":"out"},{"type":"plain","text":" 回傳值的函數之一，提供的是當相交發生時從 ray 起點至相交點的距離 "},{"type":"inlineCode","text":"distance"},{"type":"plain","text":" 。因此這一段程式碼的作用是，判斷平面 plane 與 ray 是否有相交發生，如果有的話將距離儲存進 distance。現在射線起點，相交距離都知道了，就能計算出滑鼠位置便是從該射線上從起點開始距離 distance 的地方。"}]},{"type":"paragraph","children":[{"type":"plain","text":"![[unity-dev-memo-2_3.gif]]"}]},{"type":"paragraph","children":[{"type":"plain","text":"以上就是在射線上增加元素使其可視化之後的展示，紅色點是射線起點 ("},{"type":"inlineCode","text":"ray.GetPoint(0)"},{"type":"plain","text":" )，藍色點是與平面相交點（ "},{"type":"inlineCode","text":"ray.GetPoint(distance)"},{"type":"plain","text":" ）。可以看見起點不是攝影機本身，而是在 near clipping plane 上。"}]},{"type":"heading","children":[{"type":"plain","text":"Collider.Raycast"}],"depth":3},{"type":"paragraph","children":[{"type":"plain","text":"以上都是純平面的情況，實際在遊戲中常常有地形非單純平面的情況，此時可以使用 "},{"type":"inlineCode","text":"TerrainCollider"},{"type":"plain","text":" 來計算射線與地形 terrain 的相交點。"}]},{"type":"code","lang":"csharp","text":"using System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\n\npublic class GetMousePos : MonoBehaviour {\n    TerrainCollider terrainCollider;\n    Camera camera;\n    Vector3 mousePos;\n\n    void Start () {\n        camera = Camera.main;        \n        terrainCollider = Terrain.activeTerrain.GetComponent\u003cTerrainCollider\u003e();\n    }\n\n    void Update () {\n        Ray ray = camera.ScreenPointToRay(Input.mousePosition);\n        RaycastHit hitData;\n        if(terrainCollider.Raycast(ray, out hitData, 1000)){\n            mousePos = hitData.point;\n        }\n    }\n}"},{"type":"paragraph","children":[{"type":"plain","text":"內容大致相同，只是這次判斷相交點的元素不是平面，而是地形碰撞體 "},{"type":"inlineCode","text":"terrainCollider"},{"type":"plain","text":" ，而這個函數所提供的 out 相交資料也更豐富，不只有距離，而是一整個資料形態 RaycastHit "},{"type":"link","text":"https://docs.unity3d.com/ScriptReference/RaycastHit.html","url":"https://docs.unity3d.com/ScriptReference/RaycastHit.html"},{"type":"plain","text":" ，包含 point, distance ,collider等，point 即為射線與 "},{"type":"inlineCode","text":"terrainCollider"},{"type":"plain","text":" 相交點。"}]},{"type":"paragraph","children":[{"type":"plain","text":"![[unity-dev-memo-2_4.gif]]"}]},{"type":"paragraph","children":[{"type":"plain","text":"上圖就是在不規則地形使用 "},{"type":"inlineCode","text":"terrainCollider.Raycast"},{"type":"plain","text":" 追蹤游標位置的展示，可以看見在右側遊戲畫面中游標移至山脈可見的南側時，左側的編輯器畫面也顯示游標位置的藍點直接跳過山脈北側，同時隨著地形一同起伏。"}]},{"type":"heading","children":[{"type":"plain","text":"Physics.Raycast"}],"depth":3},{"type":"paragraph","children":[{"type":"plain","text":"以上兩種實作的前提都是射線相交的對象為特定單一物件。想要判斷射線是否相交非特定物件時，使用 "},{"type":"inlineCode","text":"Physics.Raycast"},{"type":"plain","text":" 。這個函數會抓取引數的射線相交的第一個對象，且同樣提供 "},{"type":"inlineCode","text":"out RaycastHit"},{"type":"plain","text":" 資料。"}]},{"type":"code","lang":"csharp","text":"using System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\n\npublic class GetMousePos : MonoBehaviour {\n    Camera camera;\n    Vector3 mousePos;\n\n    void Start () {\n        camera = Camera.main;\n    }\n\n    void Update () {\n        Ray ray = camera.ScreenPointToRay(Input.mousePosition);\n        RaycastHit hitData;\n        if(Physics.Raycast(ray, out hitData, 1000)){\n            mousePos = hitData.point;\n\t\t\t\t\t\tGameObject hitObj = hitData.collider.transform.gameObject;\n        }\n    }\n}"},{"type":"paragraph","children":[{"type":"inlineCode","text":"Physics.Raycast"},{"type":"plain","text":" 的提供距離引數做為判斷相交的最大距離，可以依照自己需求設定。"}]},{"type":"paragraph","children":[{"type":"plain","text":"![[unity-dev-memo-2_5 1.gif]]"}]},{"type":"paragraph","children":[{"type":"plain","text":"上圖為使用 "},{"type":"inlineCode","text":"Physics.Raycast"},{"type":"plain","text":" 追蹤游標互動物件的展示，使用 "},{"type":"inlineCode","text":"RaycastHit.collider.transform.GameObject"},{"type":"plain","text":" 判斷射線的碰撞體的原物件之後就可以進行互動。"}]},{"type":"heading","children":[{"type":"plain","text":"LayerMask in Physics.Raycast"}],"depth":3},{"type":"paragraph","children":[{"type":"inlineCode","text":"Physics.Raycast"},{"type":"plain","text":" 還提供圖層引數過濾判斷射線相交對象。"}]},{"type":"code","lang":"csharp","text":"using System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\n\npublic class HighlightRayOrigin : MonoBehaviour {\n    Camera camera;\n    Vector3 mousePos;\n    LayerMask layerMask = 1 \u003c\u003c 8;\n\n    void Start () {\n        camera = Camera.main;\n    }\n\n    void Update () {\n        Ray ray = camera.ScreenPointToRay (Input.mousePosition);\n        RaycastHit hitData;\n        if (Physics.Raycast (ray, out hitData, 1000, layerMask)) {\n            mousePos = hitData.point;            \n\t\t\t\t\t\tGameObject hitObj = hitData.collider.transform.gameObject;\n        }\n    }\n}"},{"type":"paragraph","children":[{"type":"inlineCode","text":"Physics.Raycast"},{"type":"plain","text":" 的 "},{"type":"inlineCode","text":"layerMask"},{"type":"plain","text":" 引數就是指定圖層，只有在這個圖層中的物件才會觸發與射線相交的判斷。"}]},{"type":"paragraph","children":[{"type":"plain","text":"請注意，雖然這個引數的型別是 int，但其實是二進制的 int，所以直接輸入在編輯器中顯示的圖層編號是不會正常運作的，必須以 "},{"type":"inlineCode","text":"\u003c\u003c"},{"type":"plain","text":" 運算子將指定編號以二進制方式儲存在變數中再傳遞給 "},{"type":"inlineCode","text":"Physics.Raycast"},{"type":"plain","text":" 函數。"}]},{"type":"paragraph","children":[{"type":"plain","text":"![[unity-dev-memo-2_6.gif]]"}]},{"type":"paragraph","children":[{"type":"plain","text":"上圖是使用 LayerMask 過濾可互動物件的展示，只有上層物件位於可互動的圖層中，因此游標在地形或是下層物件時藍點都不會隨之移動。"}]}],"postMetadata":{"id":"unity-dev-memo-2","title":"Unity Dev Memo (2)","description":"","category":"Game Development","language":["zh-TW"],"tags":["Unity3D"],"publishDate":"2020-10-04","pathname":"unity-dev-memo-2","zhTwLink":null,"filename":"Unity Dev Memo (2) (blog)"},"categoryList":{"Game Development":5,"Life":5,"Gaming":12,"League of Legends":8,"Meta":4,"Web Development":4,"HKT48":4,"Programming":3,"Movie":2},"last5posts":[{"id":"godot-essentials","title":"Godot Essentials","description":"The biggest lessons I learned in my first Godot project.","category":"Game Development","language":["en-US"],"tags":[],"publishDate":"2024-04-21","pathname":"godot-essentials","zhTwLink":null,"filename":"Godot Essentials (blog)"},{"id":"4-years-reflection","title":"4 Years Reflection","description":"Another two years of life as a full-time developer has passed. Many things changed and many lessons learned. It's a perfect timing to look back and reflect.","category":"Life","language":["en-US"],"tags":[],"publishDate":"2024-04-08","pathname":"4-years-reflection","zhTwLink":null,"filename":"4 Years Reflection (blog)"},{"id":"improving-greatness","title":"Improving Greatness","description":"Breath of the Wild is one of the most impactful game in last decade. Yet for its successor, Nintendo built an even more polished version on an already magnificent fundamental.","category":"Gaming","language":["en-US"],"tags":[],"publishDate":"2024-03-17","pathname":"improving-greatness","zhTwLink":null,"filename":"Improving Greatness (blog)"},{"id":"s13-recap","title":"S13 Recap","description":"After a three years gap, I'm back to league.","category":"League of Legends","language":["en-US"],"tags":[],"publishDate":"2024-01-23","pathname":"s13-recap","zhTwLink":null,"filename":"S13 Recap (blog)"},{"id":"refactor-blog-2023-markdown-based-content","title":"Refactor Blog 2023: Markdown Based Content","description":"Embracing a different approach toward my own data, I made a change to the content hosting method of my blog.","category":"Meta","language":["en-US"],"tags":[],"publishDate":"2023-06-19","pathname":"refactor-blog-2023-markdown-based-content","zhTwLink":null,"filename":"Refactor Blog 2023 - Markdown Based Content (blog)"}]},"__N_SSG":true},"page":"/blog/[pathname]","query":{"pathname":"unity-dev-memo-2"},"buildId":"Ct-zOyv_Ohd6ncbBqnMnN","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>
<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Deploying React.js App on GAE | Asuka Wang</title><meta name="description" content="Asuka Wang&#x27;s blog"/><meta property="og:title" content="Deploying React.js App on GAE | Asuka Wang"/><meta property="twitter:title" content="Deploying React.js App on GAE | Asuka Wang"/><meta name="next-head-count" content="6"/><link rel="preconnect" href="/" crossorigin="anonymous"/><script id="theme-document" data-nscript="beforeInteractive">
        if (typeof window !== "undefined") {
          const savedTheme = localStorage.getItem("ASUKACHIKARU_THEME");
          const html = document.documentElement;
          const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches
            ? 'DARK'
            : 'LIGHT';
          if (savedTheme === "DARK" || systemTheme === "DARK") {
            html.classList.add('dark');
            html.style.backgroundColor = "#27211F";
          } else {
            html.classList.remove('dark');
            html.style.backgroundColor = "#F5F2E8";
          }
        }
      </script><link rel="preload" href="/_next/static/css/37c41217e71a4ebc.css" as="style"/><link rel="stylesheet" href="/_next/static/css/37c41217e71a4ebc.css" data-n-g=""/><link rel="preload" href="/_next/static/css/d8403707d10b0477.css" as="style"/><link rel="stylesheet" href="/_next/static/css/d8403707d10b0477.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-b8f8d6679aaa5f42.js" defer=""></script><script src="/_next/static/chunks/framework-114634acb84f8baa.js" defer=""></script><script src="/_next/static/chunks/main-f2ca60db2beb93ed.js" defer=""></script><script src="/_next/static/chunks/pages/_app-e93b23f29c9aa536.js" defer=""></script><script src="/_next/static/chunks/542-7be5b5539309fe0b.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bpathname%5D-d22eb341f0d05e6a.js" defer=""></script><script src="/_next/static/Wum8EVDFESa8aW9no806K/_buildManifest.js" defer=""></script><script src="/_next/static/Wum8EVDFESa8aW9no806K/_ssgManifest.js" defer=""></script></head><body><div id="__next"><main class="__variable_e0546c font-serif"><div class="text-dark bg-light dark:text-light dark:bg-dark"><div class="max-w-7xl mx-auto grid grid-cols-12 gap-0 lg:gap-4"><div class="mt-12 mb-6 col-span-10 col-start-2 lg:col-span-8 lg:col-start-3 grid grid-cols-10 text-center"><div class="col-start-1 col-span-10 text-xl lg:text-3xl font-extrabold">Asuka Wang</div><div class=" col-span-6 col-start-3 lg:col-span-6 lg:col-start-3 mt-4 flex justify-between leading-[32px] lg:leading-[40px] text-xs lg:text-base "><a href="/blog/">BLOG</a><a href="/snapshot/">SNAPSHOT</a><a href="/about/">ABOUT</a></div><div class="col-span-1 col-start-10 mt-4 flex justify-end"><button class="whitespace-pre text-right text-xs lg:text-sm leading-4">dark<!-- -->
<!-- -->mode</button></div><div class="col-span-10 my-2 border-t border-b h-2 border-dark dark:border-light"></div></div><div class="mb-6 col-span-10 col-start-2 lg:col-span-8 lg:col-start-3 text-center"><h1 class="mb-2 text-4xl lg:text-6xl lg:leading-tight font-extrabold">Deploying React.js App on GAE</h1><div class="text-md lg:text-xl"><span class="inline-block mr-2 pr-2 true">September 19, 2019</span></div></div><div class="col-span-10 col-start-2 lg:col-span-8 lg:col-start-3"><div class="mb-6 text-lg lg:text-xl lg:leading-8"><span>For people like me who have only used a static host like Amazon S3 before, deploying React app on Google App Engine is a challenge. For all the references I found it looks straightforward and easy to deploy a React app, yet I still struggled for 2 days. Here is how I did it, with the things I realized by logs and tries and errors.</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><h3 class="mt-8 text-xl lg:text-3xl font-semibold"><span>GAE is not a static host; it&#x27;s a virtual machine</span></h3></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><span>So you can&#x27;t just push the build. You have to serve it, like starting a development server. So the next problem is, how?</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><h3 class="mt-8 text-xl lg:text-3xl font-semibold"><span>With default config, GAE only executes two scripts when deploying</span></h3></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><span>They are </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">npm install</code><span> and </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">npm start</code><span>.</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><span>Like I mentioned before, for merely starting a server for React, these two seems enough. Then I found out it&#x27;s not, because default </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">npm start</code><span> provided by Create-React-App, which equals to </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">node scripts/start.js</code><span> if you check out </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">package.json</code><span>, takes much time, and it&#x27;s long enough to make the app not working. So we need a faster way to </span><span class="italic">serve</span><span> it.</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><h3 class="mt-8 text-xl lg:text-3xl font-semibold"><span>Serve can do the trick</span></h3></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><span>Literally, </span><a href="notion://www.notion.so/asukachikaru/%5B%3Chttps://github.com/zeit/serve%3E%5D(%3Chttps://github.com/zeit/serve%3E)" class="text-blue-400 underline" rel="noreferrer noopener" target="_blank">serve</a><span>.</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><span>Notice serve needs static files to run, so we need to build it first. Since GAE only runs two scripts, and building takes some time too, so I bound it to </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">postinstall</code><span> instead of </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">prestart</code><span> . By this way, GAE automatically builds right after it installs dependencies.</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><span>You can also use some host framework (like express) to do the hosting and routing stuff too.</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><h3 class="mt-8 text-xl lg:text-3xl font-semibold"><span>Config the port</span></h3></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><span>React development server default port is 3000, and serve&#x27;s is 5000, while GAE uses 8080.</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><span>The scripts in </span><code class="px-1 font-courier text-gray-300 bg-gray-700 rounded-sm">package.json</code><span> I used when finally successfully deployed looks like this:</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><pre class="my-6 border rounded-md text-base leading-4"><code class="font-courier language-json rounded-md">&quot;script&quot;: {
  &quot;postinstall&quot;: &quot;npm run build&quot;,
  &quot;start&quot;: &quot;serve -l 8080 -s build&quot;
}</code></pre></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><span>You need to configure app.yaml too, but I think many resources is talking about how to do it.</span></div><div class="mb-6 text-lg lg:text-xl lg:leading-8"><span>I hope this helps!</span></div></div><div class="mt-6 mb-12 text-center col-span-12 lg:col-span-8 lg:col-start-3"><a href="https://asukachikaru.com" rel="noopener noreferrer" target="_blank">asukachikaru.com</a> <!-- -->2018-</div></div></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postContent":[{"type":"paragraph","children":[{"type":"plain","text":"For people like me who have only used a static host like Amazon S3 before, deploying React app on Google App Engine is a challenge. For all the references I found it looks straightforward and easy to deploy a React app, yet I still struggled for 2 days. Here is how I did it, with the things I realized by logs and tries and errors."}]},{"type":"heading","children":[{"type":"plain","text":"GAE is not a static host; it's a virtual machine"}],"depth":2},{"type":"paragraph","children":[{"type":"plain","text":"So you can't just push the build. You have to serve it, like starting a development server. So the next problem is, how?"}]},{"type":"heading","children":[{"type":"plain","text":"With default config, GAE only executes two scripts when deploying"}],"depth":2},{"type":"paragraph","children":[{"type":"plain","text":"They are "},{"type":"inlineCode","text":"npm install"},{"type":"plain","text":" and "},{"type":"inlineCode","text":"npm start"},{"type":"plain","text":"."}]},{"type":"paragraph","children":[{"type":"plain","text":"Like I mentioned before, for merely starting a server for React, these two seems enough. Then I found out it's not, because default "},{"type":"inlineCode","text":"npm start"},{"type":"plain","text":" provided by Create-React-App, which equals to "},{"type":"inlineCode","text":"node scripts/start.js"},{"type":"plain","text":" if you check out "},{"type":"inlineCode","text":"package.json"},{"type":"plain","text":", takes much time, and it's long enough to make the app not working. So we need a faster way to "},{"type":"italic","text":"serve"},{"type":"plain","text":" it."}]},{"type":"heading","children":[{"type":"plain","text":"Serve can do the trick"}],"depth":2},{"type":"paragraph","children":[{"type":"plain","text":"Literally, "},{"type":"link","text":"serve","url":"notion://www.notion.so/asukachikaru/%5B%3Chttps://github.com/zeit/serve%3E%5D(%3Chttps://github.com/zeit/serve%3E)"},{"type":"plain","text":"."}]},{"type":"paragraph","children":[{"type":"plain","text":"Notice serve needs static files to run, so we need to build it first. Since GAE only runs two scripts, and building takes some time too, so I bound it to "},{"type":"inlineCode","text":"postinstall"},{"type":"plain","text":" instead of "},{"type":"inlineCode","text":"prestart"},{"type":"plain","text":" . By this way, GAE automatically builds right after it installs dependencies."}]},{"type":"paragraph","children":[{"type":"plain","text":"You can also use some host framework (like express) to do the hosting and routing stuff too."}]},{"type":"heading","children":[{"type":"plain","text":"Config the port"}],"depth":2},{"type":"paragraph","children":[{"type":"plain","text":"React development server default port is 3000, and serve's is 5000, while GAE uses 8080."}]},{"type":"paragraph","children":[{"type":"plain","text":"The scripts in "},{"type":"inlineCode","text":"package.json"},{"type":"plain","text":" I used when finally successfully deployed looks like this:"}]},{"type":"code","lang":"json","text":"\"script\": {\n  \"postinstall\": \"npm run build\",\n  \"start\": \"serve -l 8080 -s build\"\n}"},{"type":"paragraph","children":[{"type":"plain","text":"You need to configure app.yaml too, but I think many resources is talking about how to do it."}]},{"type":"paragraph","children":[{"type":"plain","text":"I hope this helps!"}]}],"postSummary":{"id":"deploying-react-app-on-gae","title":"Deploying React.js App on GAE","category":"Front-end","language":["en-US"],"tags":["GAE","React.js"],"publishDate":"2019-09-19","pathname":"deploying-react-app-on-gae","zhTwLink":null,"filename":"Deploying React.js App on GAE (blog)"}},"__N_SSG":true},"page":"/blog/[pathname]","query":{"pathname":"deploying-react-app-on-gae"},"buildId":"Wum8EVDFESa8aW9no806K","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>